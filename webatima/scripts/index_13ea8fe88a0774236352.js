(window.webpackJsonp=window.webpackJsonp||[]).push([[2],{3:function(t,e,a){"use strict";a.r(e);var i={z_effective:1,dedx_straggling:0},n={z_effective:7,dedx_straggling:0},s=[{name:"atima v1.3",config:i},{name:"atima v1.4",config:n}];function o(t){this.z_effective=i.z_effective,this.dedx_straggling=i.dedx_straggling,t&&(t.z_effective&&(this.z_effective=t.z_effective),t.dedx_straggling&&(this.dedx_straggling=t.dedx_straggling))}o.prototype.is_same=function(t){return this.z_effective==t.z_effective&&this.dedx_straggling==t.dedx_straggling},o.prototype.set=function(t){this.z_effective=t.z_effective,this.dedx_straggling=t.dedx_straggling};var l=a(9),r=a(25),c=a(24),d=d||{};d.container="mw-100 mw9-ns center ph2-ns",d.container_narrow="mw-100 mw8-ns center ph4-ns",d.my="my",d.table="my mw-8 centered f5",d.thead_tr="my",d.tr="my",d.th="my",d.td="my",d.div_column="flex flex-column items-center",d.div_row="flex flex-wrap",d.div_row_centered="flex flex-wrap items-center",d.div_cell="pa2",d.div_cell_auto="pa2 w-auto f5",d.div_cell_100="w-100 pa2",d.div_cell_20="w-100 w-20-l pa2-ns",d.div_cell_20a="w-auto w-20-l pa2-ns",d.div_cell_80="w-100 w-80-l pa2-ns",d.button_full="dib tc f5 w-100 ph3 pv2 link dim white bg-hcolor br3 mb2 pointer",d.button="dib tc f5 fl ph3 pv2 link dim white bg-hcolor br2 mb2 pointer",d.button_ns="dn dib-ns tc f5 fl ph3 pv2 link dim white bg-hcolor br2 mb2 pointer",d.button_inverted="dib f5 fl ph3 pv2 link dim white hcolor br2 mb2 pointer ba b--hcolor",d.button_pill="dib f5 ph3 pv2 link dim white bg-hcolor br-pill mb2 pointer",d.button_svg="f5 fl ph1 pv1 link dim pointer",d.card="db center mv2 br3 shadow-4",d.card_header="f5 bg-hcolor white pv2 ph3",d.card_main="f6 pa2 ba b--hcolor br3 br--bottom",d.box="db center br3 shadow-4",d.heading="f2",d.heading_medium="f3",d.h3="f4 b sans-serif w-100 mv1 tc",d.form_element="mt2 ml3 w-100 w-auto-ns",d.label="db f5 pa1",d.ul="list pl0",d.li="ph2",d.footer="fixed bg-near-black w-100 bottom-0",d.header="fixed bg-black w-100 ph1 pv1 pv2-ns ph2-ns",d.nav="bg-black overflow-hidden  br3 br--bottom",d.nav_item="dn db-ns pv3 tc pointer dim f4 fw6 mh2 white link fl",d.nav_item_sticky="db pv3 tc pointer dim f4 fw6 mh2 white link fl",d.nav_item_small="dn-ns db pv3 tc pointer dim f4 fw6 mh2 white link center",d.nav_item_right="dn db-ns pv3 tc pointer dim f4 fw6 mh2 white link fr",d.dropdown="dropdown dn db-ns pv3 tc overflow-hidden pointer f4 fw6 mh2 white link fr w-auto",d.dropdown_content="dropdown-content dn absolute z-1 shadow-4 w-auto pa2 bg-white black tl",d.color_error="text-error",d.error_badge="bg-dark-red pa2 ma2 br2 dib",d.padding_vertical="pv2",d.combine=function(t){return t.join(" ")};var u=a(23);function h(t,e,a){var i;return function(){var n=arguments;clearTimeout(i),i=setTimeout(function(){i=null,t.apply(a||this,n)},e||250)}}function p(t,e,a){return m("a",{class:a||d.button,onclick:function(){m.route.set(e)}},t)}function v(t,e,a){return m("a",{class:a||d.button,onclick:e},t)}function f(t){return m("span",{class:d.color_error},t)}function g(t){return m("div",{class:d.error_badge},t)}function y(t,e){var a=new Blob(["string"==typeof t?t:JSON.stringify(t,null,"\t")],{type:"text/plain;charset=utf-8"});Object(u.saveAs)(a,e)}function _(t,e){return[m("input",{class:"my-remove",type:"file",id:t.id,onchange:function(t){e(t.target.files[0]),t.target.value=null}}),m("a",{class:t.class,onclick:function(){document.getElementById(t.id).click()}},t.title)]}function b(t,e,a){return function(i){i.redraw=!1,e.call(a||this,t in i.currentTarget?i.currentTarget[t]:i.currentTarget.getAttribute(t))}}function w(t,e){return function(a){a.redraw=!1,t.call(e||this)}}function x(t){var e=[];return t.forEach(function(t){var a=new Promise(function(e,a){var i=document.createElement("script");i.src=t,i.async=!1,i.onload=function(){e()},i.onerror=function(){a()},document.head.appendChild(i)});e.push(a)}),Promise.all(e)}var F={view:function(t){return m("article",{class:d.card,style:"overflow:hidden;"},[m("div",{class:d.card_header},t.attrs.title),m("div",{class:d.card_main},t.attrs.content)])}},E={visible:!1,off:function(t){document.getElementById(t).style.display="none",E.visible=!1},toggle:function(t){var e=document.getElementById(t);E.visible?e.style.display="none":e.style.display="block",E.visible=!E.visible},oninit:function(){E.visible=!1},view:function(t){var e=t.attrs,a=E.visible?e.title+" ^":e.title+" +";return m("div",{class:E.visible?d.box:""},[v(a,E.toggle.bind(t.state,e.id),d.button_full),m("div",{class:d.div_cell,id:e.id,style:"display:none;"},e.content)])}},N={};N.oncreate=function(t){var e=t.attrs;if(e.values.length<1)return null;var a,i=(a=e.fig.id,[document.getElementById(a).clientWidth,document.getElementById(a).clientHeight]),n=i[0]-90,s=2*i[0]/3|0;n<400&&(n=400),s<300&&(s=300),e.fig.set_width(n),e.fig.set_height(s),e.fig.show()},N.view=function(t){var e=t.attrs;return e.values.length<1?null:[m("div",{class:d.div_row},[e.plot_options?m("div",{class:d.div_cell_20},[m("label",{class:d.label},"Plot"),m("select",{onchange:m.withAttr("value",e.change_y_axis)},e.plot_options.map(function(t){return m("option",{value:t.value},t.name)}))]):null,m("div",{class:d.div_cell_80,id:e.fig.id})]),m("div",{class:d.div_row},v("Save Data",function(){var t=Object.keys(e.values[0]),a=e.values.map(function(e){return t.map(function(t){return"string"==typeof e[t]?e[t]:e[t].toPrecision(5)}).join(" ")});y(t.join(" ")+"\n"+a.join("\n"),"data.txt")}))]};var A=a(8),k=a(4),B=a(13);function T(t){if(t>0&&t<99)return r.a.GetDensity(t);if(t>200){var e=l.a.Get(t);if(e.density)return e.density}return 0}var M=function(t){var e=[];if(t.hasOwnProperty("c"))for(var a in t.c)t.c.hasOwnProperty(a)&&e.push([a,t.c[a]]);if(e.length)return m("table",{class:d.table},[m("thead",{},m("tr",{class:d.thead_tr},[m("th",{class:d.th},"Element"),m("th",{class:d.th},"Weight Fraction")])),m("tbody",{},[e.map(function(t){return m("tr",{class:d.tr},[m("td",{class:d.td},t[0]),m("td",{class:d.td},t[1])])})])])},S=function(t){if(this.name=t.name||"",this.symbol=t.symbol||"",this.A=t.A||"",this.mass=t.mass||"",this.Z=t.Z||"",this.rho=t.rho||0,this.th=t.th||0,this.gas=t.gas||!1,this.l=0,this.I=t.I||0,t.l)this.l=t.l;else{var e=parseFloat(t.rho);!isNaN(e)&&e>0&&(this.l=(parseFloat(t.th)/e/1e3).toFixed(4))}if(t.mass||(""===this.A?this.mass=c.a.GetMass(this.Z).toPrecision(5)||"":this.mass=A.a.GetNucData(parseInt(t.A),parseInt(t.Z)).M||""),0==this.symbol.length)if(this.Z<120)this.symbol=k.a.GetSymbol(this.A,this.Z);else{var a=l.a.Get(this.Z);this.symbol=a.key?a.key:"",this.mass="",this.A=""}};S.prototype.toArray=function(){var t=parseInt(this.Z);if(isNaN(t))return[];var e=parseFloat(this.rho);if(isNaN(e))return[];var a,i,n=parseFloat(this.th);if(isNaN(n))return[];if(""===this.mass||null===this.mass)a=0;else if(a=parseFloat(this.mass),isNaN(a)||a<0)return[];""===this.A||null===this.A?i=0:(i=parseFloat(this.A),(isNaN(i)||i<0)&&(i=0));var s=0;if(""!==this.I&&null!==this.I){var o=parseFloat(this.I);!isNaN(o)&&o>0&&(s=o)}return[i,t,e,n,this.gas?1:0,a,s]},S.prototype.toObject=function(){var t=parseInt(this.Z);if(isNaN(t))return{};var e=parseFloat(this.rho);if(isNaN(e))return{};var a,i,n=parseFloat(this.th);if(isNaN(n))return{};if(""===this.mass||null===this.mass)a=0;else if(a=parseFloat(this.mass),isNaN(a)||a<0)return{};""===this.A||null===this.A?i=0:(i=parseFloat(this.A),(isNaN(i)||i<0)&&(i=0));var s=0;if(""!==this.I&&null!==this.I){var o=parseFloat(this.I);!isNaN(o)&&o>0&&(s=o)}return{A:i,Z:t,rho:e,th:n,mass:a,gas:this.gas?1:0,I:s,name:this.name}};var j={};j.vm={layers:[],editindex:-1,thickness:0,length:0,calculate:function(){this.thickness=0,this.length=0;for(var t=0;t<this.layers.length;t++){var e=this.layers[t];this.thickness=this.thickness+parseFloat(e.th),this.length=this.length+parseFloat(e.l)}}},j.ui={},j.ui.changeSymbol=function(t,e){var a,i,n=j.vm.layers[t],s=k.a.GetNuc(e);(s[1]<1&&(n.Z="",n.A="",n.mass="",s[1]=l.a.GetZ(e)),s[0]>0&&(n.mass=A.a.GetNucData(s[0],s[1]).M.toPrecision(7),n.A=s[0].toString()),0===s[0]&&s[1]>0&&(n.A="",n.mass=c.a.GetMass(s[1]).toPrecision(7)),s[1]>0)&&(n.Z=s[1].toString(),i=(a=T(s[1]))<.01&&a>0?1:0,n.rho=a,n.gas=i);n.symbol=e,this.changel(t,n.l)},j.ui.changeZ=function(t,e){var a=j.vm.layers[t],i=parseInt(e);if(a.Z=e,a.I="",isNaN(i)||i<1)return a.A="",a.mass="",void(a.symbol="");var n,s,o,r=parseInt(a.A);if((isNaN(r)||r<1)&&(r=0),i<120&&(n=k.a.GetSymbol(r,i),j.vm.layers[t].mass=r>0?A.a.GetNucData(r,i).M.toPrecision(7):c.a.GetMass(i).toPrecision(7)),i>200){var d=l.a.Get(i);n=d.key?d.key:"",j.vm.layers[t].mass="",j.vm.layers[t].A=""}o=(s=T(i))<.01&&s>0?1:0,a.symbol=n,a.rho=s,a.gas=o,this.changel(t,a.l)},j.ui.changeA=function(t,e){var a=j.vm.layers[t],i=parseInt(e),n=parseInt(a.Z);if(isNaN(i)||i<0){var s=k.a.GetSymbol(0,n);return a.symbol=s,a.A="",a.mass=c.a.GetMass(n).toPrecision(7),void m.redraw()}a.A=i;var o=k.a.GetSymbol(i,n);a.symbol=o;var l=A.a.GetNucData(i,n);l.M?a.mass=l.M.toPrecision(7):a.mass="",this.changel(t,a.l),m.redraw()},j.ui.changerho=function(t,e){var a=j.vm.layers[t],i=parseFloat(e),n=parseFloat(a.l);if(a.rho=e,!(isNaN(i)||i<0)){var s=n*i*1e3;a.th=s.toPrecision(3),m.redraw()}},j.ui.changel=function(t,e){var a=j.vm.layers[t],i=parseFloat(e),n=parseFloat(a.rho),s=parseFloat(a.th);a.l=e,isNaN(i)||i<0||isNaN(n)||n<0||(s=i*n*1e3,a.th=s.toPrecision(4),m.redraw())},j.ui.changeth=function(t,e){var a=j.vm.layers[t],i=parseFloat(e),n=parseFloat(a.rho),s=parseFloat(a.l);a.th=e,isNaN(i)||i<0||isNaN(n)||n<0||(s=i/n/1e3,a.l=s.toPrecision(4),m.redraw())},j.ui.Remove=function(t){-1==j.vm.editindex&&(j.vm.layers.splice(t,1),V.clear_cache(),V.Save(),j.vm.calculate(),m.redraw())},j.ui.Add=function(){j.vm.editindex=j.vm.layers.length,j.vm.layers.push(new S({symbol:"",name:"",A:"",Z:"",mass:"",rho:0,th:0,gas:!1}))},j.ui.Down=function(t){if(!(t>=j.vm.layers.length-1)&&-1==j.vm.editindex){var e=j.vm.layers[t];j.vm.layers[t]=j.vm.layers[t+1],j.vm.layers[t+1]=e,V.clear_cache(),V.Save(),m.redraw()}},j.ui.Up=function(t){if(!(t<1)&&-1==j.vm.editindex){var e=j.vm.layers[t];j.vm.layers[t]=j.vm.layers[t-1],j.vm.layers[t-1]=e,V.clear_cache(),V.Save(),m.redraw()}},j.ui.EditDone=function(){var t=j.vm.layers[j.vm.editindex];""===t.Z&&(alert("Wrong matter defined, matter removed"),j.vm.editindex=-1,j.ui.Remove(j.vm.editindex)),""===t.name&&(t.name="Material_"+j.vm.editindex),isNaN(parseFloat(t.l))&&(t.l=0,t.th=0),isNaN(parseFloat(t.th))&&(t.l=0,t.th=0),isNaN(parseFloat(t.rho))&&(t.rho=T(t.Z)),t.l=parseFloat(t.l),t.th=parseFloat(t.th),t.rho=parseFloat(t.rho),j.vm.editindex=-1,V.clear_cache(),V.Save(),j.vm.calculate()},j.ui.Edit=function(t){-1==j.vm.editindex&&(j.vm.editindex=t,m.redraw())},j.view=function(t){var e,a,i,n,s=t.state.vm,o=t.state.ui;return s.editindex>-1?(e=s.layers[s.editindex],a=s.editindex,i=o,m("div",{onkeyup:(n=i.EditDone.bind(i),function(t){t.redraw=!1,27===t.keyCode&&(n(),m.redraw())})},[m("div",{class:d.h3},"Material #"+a),m("div",{class:d.div_row},[m("div",{class:d.form_element},[m("label",{class:d.label,for:"input_material_name",title:"Name of the matter, ie vacuum window, this is optional"},"Name"),m("input",{type:"text",style:"width:10em;",placeholder:"optional name",id:"input_material_name",oninput:function(t){t.redraw=!1,e.name=t.currentTarget.value},value:e.name})]),m("div",{class:d.form_element},[m("label",{class:d.label,for:"input_material_symbol",title:"Type element or nucleus symbol or compund matter ie air, P10, water..."},"Symbol"),m("input",{type:"text",style:"width:10em",placeholder:"i.e. Fe, 12C",id:"input_material_symbol",oninput:m.withAttr("value",i.changeSymbol.bind(i,a)),value:e.symbol})]),m("div",{class:d.form_element},[m("label",{class:d.label,for:"input_material_A",title:"Mass number or leave empty or zero for natural target"},"A"),m("input",{type:"text",style:"width:7em;",id:"input_material_A",oninput:b("value",i.changeA.bind(i,a)),value:e.A})]),m("div",{class:d.form_element},[m("label",{class:d.label,for:"input_material_Z"},"Z"),m("input",{type:"text",style:"width:7em;",id:"input_material_Z",oninput:m.withAttr("value",i.changeZ.bind(i,a)),value:e.Z<200?e.Z:""})])]),m("div",{class:d.div_row},[m("div",{class:d.form_element},[m("label",{class:d.label,for:"input_material_mass"},m.trust("mass<br>(u)")),m("input",{type:"text",style:"width:7em;",id:"input_material_mass",oninput:function(t){t.redraw=!1,e.mass=t.currentTarget.value},value:e.mass})]),m("div",{class:d.form_element},[m("label",{class:d.label,for:"input_material_rho"},m.trust("density<br>(g/cm<sup>3</sub>)")),m("input",{type:"text",style:"width:7em;",id:"input_material_rho",oninput:b("value",i.changerho.bind(i,a)),value:e.rho})]),m("div",{class:d.form_element},[m("label",{class:d.label,for:"input_material_th"},m.trust("Thickness<br>(mg/cm<sup>2</sub>)")),m("input",{type:"text",style:"width:7em;",id:"input_material_th",oninput:b("value",i.changeth.bind(i,a)),value:e.th})]),m("div",{class:d.form_element},[m("label",{class:d.label,for:"input_material_l"},m.trust("Length<br>(cm)")),m("input",{type:"text",style:"width:7em;",id:"input_material_l",oninput:b("value",i.changel.bind(i,a)),value:e.l})]),m("div",{class:d.form_element},[m("label",{class:d.label},m.trust("Thickness<br>calculator")),m(L,{index:a}),p("Show Plots","/materialplot")])]),m("div",{class:d.combine([d.div_row,"items-center mt2"])},[m("div",{class:d.div_cell_20},m("a",{class:d.button_full,onclick:i.EditDone.bind(i)},"Done")),m("div",{class:d.div_cell_80},["Compounds:",function(t){var e=[];for(var a in l.a.map){var i;i=l.a.GetName(a),e.push([a,i])}return e.sort(function(t,e){return t[1].localeCompare(e[1])}),m("select",{id:"id_compound_select",class:"db w-100",onchange:m.withAttr("value",t.onchange)},m("option",{value:""},"Add Compound"),e.map(function(t){return m("option",{value:t[0]},t[1])}))}({onchange:i.changeZ.bind(i,a)})])]),e.Z>200?m("div",{class:d.combine([d.div_row,"items-center justify-center"])},[m("div",{class:d.div_cell},[m("div",{class:d.h3},l.a.GetName(e.Z)),M(l.a.Get(e.Z))]),m("div",{class:d.form_element},[m("label",{class:d.label,for:"input_material_I",title:"Mean Ionization Potential in eV or empty for elemental ionization potentials"},"<I>",m("input",{class:"db",type:"text",style:"width:7em;",id:"input_material_I",onkeyup:function(t,e){return function(a){a.redraw=!1,13===a.keyCode?(t(),m.redraw()):27===a.keyCode&&(e(),m.redraw())}}(i.EditDone.bind(i),i.EditDone.bind(i)),oninput:function(t){if(t.redraw=!1,0!=t.currentTarget.value.length){var a=parseFloat(t.currentTarget.value);!isNaN(a)&&a>0&&(e.I=a,m.redraw())}else e.I=0},value:e.I>0?e.I:""}))]),m("div",{class:d.div_cell},m("a",{href:"physics.html#compounds",target:"_blank",title:"Bragg Rules is used to calculate energy loss of compounds. For custom non-elemental Ionization potential enter the mean I value in eV units or leave empty, click for more details"},m.trust('<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>')))]):null])):m("div",{style:"overflow-x:auto;"},[m("table",{class:d.table},[m("thead",{class:""},[m("tr",[m("th",{class:d.th},"#"),m("th",{class:d.th},"name"),m("th",{class:d.th},"matter"),m("th",{class:d.th},m.trust("density<br>(g/cm<sup>3</sub>)")),m("th",{class:d.th},m.trust("thick.<br>(mg/cm<sup>2</sup>)")),m("th",{class:d.th},m.trust("thick.<br>(cm)")),m("th",{class:d.th},"")])]),m("tbody",s.layers.map(function(t,e){return m("tr",{class:d.tr,ondblclick:o.Edit.bind(o,e)},[m("td",{class:d.td},e),m("td",{class:d.td},t.name),m("td",{class:d.td},t.symbol),m("td",{class:d.td},t.rho),m("td",{class:d.td},t.th>0?t.th:f(t.th)),m("td",{class:d.td},t.l>0?t.l:f(t.l)),m("td",{class:d.td},m("span",{class:"flex flex-row dib bg-moon-gray br-pill ph2"},[m("a",{class:d.button_svg,onclick:w(o.Up.bind(o,e)),title:"Move Up"},m.trust('<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"/></svg>')),m("a",{class:d.button_svg,onclick:w(o.Down.bind(o,e)),title:"Move Down"},m.trust('<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z" fill="#010101"/></svg>')),m("a",{class:d.button_svg,onclick:w(o.Edit.bind(o,e)),title:"Edit"},m.trust('<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/><path d="M0 0h24v24H0z" fill="none"/></svg>')),m("a",{class:d.button_svg,onclick:w(o.Remove.bind(o,e)),title:"Delete"},m.trust('<svg height="24" width="24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'))]))])}))]),m("div",{class:d.combine([d.div_row,d.padding_vertical])},[m("div",{class:d.div_cell_20},m("a",{class:d.button_pill,onclick:o.Add.bind(o)},"Add Matter")),m("div",{class:d.div_cell_80},s.layers.length?m("div",["Total thickness = "+s.thickness.toFixed(3)+" mg/cm2",m("br"),"Total length = "+s.length.toFixed(3)+" cm"]):null)]),m("span",[_({class:d.button,id:"loadmatter",title:"Add from File"},V.AddLayersFromFile),s.layers.length?[v("Save as MOCADI",function(){y(V.MOCADIstr(),"input.in")},d.button_ns),p("Plots","/plot")]:null])])};var C={th:0,l:0,calculate_th:function(t,e,a){var i=j.vm.layers[t].rho;i=parseFloat(i);var n=parseFloat(a);isNaN(n)||n<0?console.log("could not parse number"):z.get_energy_out().then(function(e){return t>=e.length?-1:t>0?e[t-1]:V.projectile.state.T}).then(function(a){C.th=-1,C.l=-1,a<0||0==e&&n>a||1==e&&n>1||z.get_data(z.prepare_one(t)).then(function(t){var s=new B.a(t[0].energy,t[0].range);C.th=0==e?1e3*(s.at(a)-s.at(n)):s.at(a)*n*1e3,C.l=C.th/i/1e3,m.redraw()})})}},L={submit:function(t,e,a){e>0&&(j.ui.changeth(t,e.toFixed(2)),a&&a.apply(this))},oninit:function(){C.th=0,C.l=0},view:function(t){var e=t.attrs.index,a=C;return m(E,{id:"_thcal",title:"Calculate",content:m("div",{class:d.div_column},[m("div","Adjust thickness to: "),m("label",{class:d.label,for:"input_Eout",title:"Enter Energy after material"},"Eout (MeV/u)"),m("input",{type:"text",style:"width:7em;",id:"input_Eout",oninput:b("value",h(a.calculate_th.bind(t.state,e,0),500))}),m("label",{class:d.label,for:"input_RangeFraction",title:"Enter Fraction of Range"},"th/range"),m("input",{type:"text",style:"width:7em;",id:"input_RangeFraction",oninput:b("value",h(a.calculate_th.bind(t.state,e,1),500))}),a.th>=0?m("div",{class:d.div_cell},["Th. = "+a.th.toFixed(2),m.trust(" mg/cm<sup>2</sup><br>"),"Length    = "+a.l.toFixed(5)+" cm"]):m("div",f("Wrong value!")),a.th>0?v("Submit Thickness",t.state.submit.bind(t.state,e,a.th,E.off.bind(this,"_thcal"))):null])})}},P=a(12),O=a(11),Z=a.n(O),I=a(15),V=V||{};V.state={},V.state.nuc="",V.state.T=0,V.state.matter=[],V.state.config=new o,V.info="",V.projectile=new I.a,V.projectile.Set.T(100),V.MatterEditor=j,window.App=V,V.LoadJSONFile=function(t){var e=new FileReader;e.onload=function(t){try{V.Load(JSON.parse(t.target.result)),V.Save()}catch(t){alert("Failed to load file")}finally{m.redraw()}},e.readAsText(t)},V.AddLayersFromFile=function(t){var e=new FileReader;e.onload=function(t){try{V.AddLayers(JSON.parse(t.target.result)),V.Save()}catch(t){alert("Failed to add material layers"),V.report(t)}finally{m.redraw()}},e.readAsText(t)},V.get_editindex=function(){return j.vm.editindex},V.get_edit_layer=function(){return j.vm.editindex>-1?j.vm.layers[j.vm.editindex]:null},V.Load=function(t){t&&(t.hasOwnProperty("nuc")&&Array.isArray(t.nuc)&&V.projectile.SetNucleus(t.nuc[0],t.nuc[1],t.nuc[2]),t.hasOwnProperty("T")&&V.projectile.Set.T(t.T),t.hasOwnProperty("projectile")&&t.projectile.hasOwnProperty("A")&&t.projectile.hasOwnProperty("Z")&&(V.projectile.SetNucleus(t.projectile.A,t.projectile.Z,t.projectile.Q),t.projectile.hasOwnProperty("T")&&V.projectile.Set.T(t.projectile.T)),j.vm.layers.length=0,V.AddLayers(t),j.vm.calculate(),t.config&&V.state.config.set(t.config),V.loaded=!0,V.Save())},V.AddLayers=function(t){if(t.matter)for(var e=0;e<t.matter.length;e++){var a=t.matter[e];if(Array.isArray(a)){var i={};i.name="matter"+e,i.A=a[0],i.Z=a[1],i.rho=a[2],i.th=a[3],i.gas=a[4],i.mass=a[5],i.I=a[6],j.vm.layers.push(new S(i))}else j.vm.layers.push(new S(a))}},V.Save=function(){V.state.nuc=V.projectile.GetNucleus(),V.state.T=V.projectile.state.T,V.state.matter=j.vm.layers,V.state.units=[1,1e3,1],P.a.save("state",V.state)},V.DeleteStorage=function(){localStorage.clear()},V.MOCADIstr=function(){var t=V.projectile.GetNucleus(),e=V.projectile.state.T,a=j.vm.layers,i="epax 2\natima-1.0\noption listmode tree\n";i=i+"BEAM\n20000\n"+e+", 0, "+t[0]+", "+t[1]+", "+(t[1]-t[2])+"\n",i+="2\n0, 0, 0, 0, 0\n",i+="2\n0, 0, 0, 0, 0\n",i+="2\n0, 0, 0, 0, 0\n",i+="*\nERWARTUNGSWERTE START\nSAVE START";for(var n=0;n<a.length;n++){var s="\n*** "+a[n].name+" ***\nMATTER\n"+(a[n].A||0)+", "+a[n].Z+", "+1e3*a[n].rho;s=s+"\n3, "+a[n].th,s+="\n0\n0, 0, 0",i+=s+="\n1, 1, 0\n0"}return i+="\n*\nERWARTUNGSWERTE END\nSAVE END",i+="\nEND"},V.fileapi=!1,V.datavalid=!1,V.loaded=!1,V.clear_cache=function(){V.datavalid=!1,z&&z.clear()},V.CheckBrowser=function(){var t=!0;if(window.FileReader||(t=!1),window.localStorage||(t=!1),!("startsWith"in String.prototype)){x(["https://cdn.polyfill.io/v2/polyfill.min.js?features="+["String.prototype.startsWith"].join(",")+"&flags=gated,always"])}return t},V.load_config=function(t){return z.load_config(t).then(function(e){!e.error&&e.input||(alert("Failed to load remote configuration:"+e.error),V.report("failed to load remote config, uid="+t)),V.Load(e.input)}).catch(function(){alert("Failed to load remote configuration"),V.report("failed to load remote config, uid="+t)})},V.report=function(t,e){console.log(t);var a=null;e&&(a={extra:e}),"string"==typeof t?Z.a.captureMessage(t,a):Z.a.captureException(t,a)};var z={energy_min:.001,energy_max:1e5,epsilon:1e-9,url:"https://isotopea.com/api/catima/",check_material_duplicate:function(t,e){return t.some(function(t){return t.A==e.A&&t.Z==e.Z&&t.mass==e.mass})},prepare:function(t,e){var a={},i=V.projectile.state,n=V.MatterEditor.vm.layers;if(n.length<1||i.T<.001)return{};a.projectile={mA:i.mA,A:i.A,Z:i.Z,Q:i.Q,T:i.T},a.matter=[];for(var s=0;s<n.length;s++){var o=n[s].toObject(),l=!1;t&&(l=z.check_material_duplicate(a.matter,o)),e?n[s].rho>0&&n[s].th>0&&(t&&l||a.matter.push(o)):t&&l||a.matter.push(o)}return V.state.config&&(a.config=V.state.config),a},prepare_one:function(t){var e={},a=V.projectile.state,i=V.MatterEditor.vm.layers;if(i.length<1||a.T<.001)return{};if(e.projectile={mA:a.mA,A:a.A,Z:a.Z,Q:a.Q,T:a.T},e.matter=[],t>=i.length)return{};var n=i[t].toObject();return i[t].rho>0&&e.matter.push(n),V.state.config&&(e.config=V.state.config),e},check_cache:function(t){for(var e=[],a=0;a<z.data.length;a++){var i=z.data[a];if(i.Zm>200&&i.Zm==t.Z){if(i.I>0&&t.I!=i.I)continue;e.push(i);break}if(i.Zm==t.Z&&i.Am==t.A&&Math.abs(i.M-t.mass)<z.epsilon){if(i.I>0&&t.I!=i.I)continue;e.push(i);break}}return e},data:[],clear:function(){z.data=[]},check_input:function(t){return!(!t.projectile&&t.projectile.T>0)&&(!(!t.matter||!Array.isArray(t.matter))&&!(t.matter.length<1))},calculate:function(t){return z.check_input(t)?m.request({method:"POST",url:z.url+"calculate",data:t,background:!0}).then(function(t){return t},function(){return V.report("Catima could not retrieve data"),{error:"Failed to retrieve data"}}):(V.report("wrong input",t),Promise.resolve({}))},get_data:function(t){if(!z.check_input(t))return V.report("wrong input",t),Promise.resolve([]);if(1==t.matter.length){var e=z.check_cache(t.matter[0]);if(1==e.length)return Promise.resolve(e)}return m.request({method:"POST",url:z.url+"data",data:t,background:!1}).then(function(t){if(!t.data)return[];z.data=[];for(var e=0;e<t.data.length;e++){var a={};a.energy=new Float32Array(t.energy),a.projectile=t.projectile,a.dEdx=new Float32Array(t.data[e].dEdx),a.range=new Float32Array(t.data[e].range);var i=parseInt(t.data[e].Zm),n=parseFloat(t.data[e].Am);a.Am=n,a.Zm=i,a.M=t.data[e].M,a.I=t.data[e].I?t.data[e].I:0,z.data.push(a)}return z.data},function(){return[]})},energy_out:function(t,e,a,i){var n=i.at(t),s=a.at(t);if(n<e)return 0;var o=t-e*s;if(o<.001)return 0;for(var l=0;l<100;l++){var r=n-i.at(o)-e;if(Math.abs(r)<1e-4)return o;if((o-=-r*s)<.001)return 0;s=a.at(o)}return-1},Eout_vs_thickness:function(t,e){var a=new B.a(t.energy,t.dEdx),i=new B.a(t.energy,t.range),n=i.at(e),s=100;s>1e3&&(s=1e3),s<10&&(s=10);var o=e/s;o<.001&&(o=.001);var l=new Float32Array(s),r=new Float32Array(s),c=new Float32Array(s),d=new Float32Array(s),u=e;l[0]=0,r[0]=u,c[0]=0,d[0]=a.at(e);for(var m=1;m<s;m++){u-=o,r[m]=u;var h=n-i.at(u);l[m]=h;var p=e-u;c[m]=p*t.projectile.A,d[m]=a.at(u)}return[l,r,c,d]},get_energy_out:function(){var t=V.MatterEditor.vm.layers;return 1==t.length&&0==t[0].th?Promise.resolve([V.projectile.state.T]):z.get_data(z.prepare()).then(function(){for(var e=[],a=V.projectile.state.T,i=0;i<t.length;i++){var n=z.check_cache(t[i]);if(1!=n.length)return console.log("cache not found?, length = "+n.length),V.report("Cache not found? "+n.length),[];var s=z.Eout_vs_thickness(n[0],a);a=new B.a(s[0],s[1]).at(.001*t[i].th),e.push(a)}return e})},load_config:function(t){return m.request({method:"POST",url:z.url+"load",data:{id:t}})}},G={};function D(t){return m("div",{class:d.form_element},[m("label",{class:d.label,for:t.id},t.label),m("input",{class:"db",id:t.id||"_id"+t.label,value:t.value,type:t.type||"text",placeholder:t.placeholder||"",style:t.style||"",oninput:t.oninput})])}G.ui={},G.nuc={},G.oninit=function(){G.nuc=V.projectile,G.ui.uiupdate(),V.clear_cache()},G.ui.uiupdate=function(){G.ui.Symbol=G.nuc.state.Symbol,G.ui.A=G.nuc.state.A,G.ui.Z=G.nuc.state.Z,G.ui.Q=G.nuc.state.Q,G.ui.T=G.nuc.state.T.toFixed(4),G.ui.Brho=G.nuc.state.Brho.toFixed(4),G.ui.Beta=G.nuc.state.Beta.toFixed(6),G.ui.Gamma=G.nuc.state.Gamma.toFixed(5),G.ui.P=G.nuc.state.P.toFixed(3),G.ui.Nth=G.nuc.state.Nth.toFixed(4),isNaN(G.ui.Nth)&&(G.ui.Nth=""),V.clear_cache()},G.ui.changesymbol=function(t){G.ui.Symbol=t,G.nuc.SetNucleusSymbol(t)&&G.ui.uiupdate()},G.ui.changeA=function(t){G.ui.A=t;var e=parseFloat(t);!isNaN(e)&&G.nuc.Set.A(e)&&(G.ui.uiupdate(),G.ui.A=t)},G.ui.changeZ=function(t){G.ui.Z=t;var e=parseFloat(t);!isNaN(e)&&G.nuc.Set.Z(e)&&(G.ui.uiupdate(),G.ui.Z=t)},G.ui.changeQ=function(t){G.ui.Q=t;var e=parseFloat(t);!isNaN(e)&&G.nuc.Set.Q(e)&&(G.ui.uiupdate(),G.ui.Q=t)},G.ui.changeT=function(t){G.ui.T=t;var e=parseFloat(t);isNaN(e)||G.nuc.Set.T(e)&&(G.ui.uiupdate(),G.ui.T=t)},G.ui.changeBeta=function(t){G.ui.Beta=t;var e=parseFloat(t);isNaN(e)||G.nuc.Set.Beta(e)&&(G.ui.uiupdate(),G.ui.Beta=t)},G.ui.changeGamma=function(t){G.ui.Gamma=t;var e=parseFloat(t);isNaN(e)||G.nuc.Set.Gamma(e)&&(G.ui.uiupdate(),G.ui.Gamma=t)},G.ui.changeBrho=function(t){G.ui.Brho=t;var e=parseFloat(t);isNaN(e)||G.nuc.Set.Brho(e)&&(G.ui.uiupdate(),G.ui.Brho=t)},G.ui.changeP=function(t){G.ui.P=t;var e=parseFloat(t);isNaN(e)||G.nuc.Set.P(e)&&(G.ui.uiupdate(),G.ui.P=t)},G.ui.changeNth=function(t){G.ui.Nth=t;var e=parseFloat(t);isNaN(e)||G.nuc.Set.Nth(e)&&(G.ui.uiupdate(),G.ui.Nth=t)},G.ui.done=function(){G.nuc.state.T>z.energy_max&&(alert("Maximal allowed energy is "+z.energy_max+" MeV/u"),G.nuc.Set.T(z.energy_max)),G.nuc.state.T<z.energy_min&&alert("Set Energy more than "+z.energy_min+" MeV/u"),V.Save(),m.route.set("/")},G.view=function(t){var e=function(t){return m("div",{class:d.div_cell},t)},a=t.state.ui,i=A.a.GetNucData(G.nuc.state.A,G.nuc.state.Z),n=A.a.GetNucS(G.nuc.state.A,G.nuc.state.Z);return m("div",[m("h2","Projectile"),m("div",{class:d.div_row},[e(D({label:"Symbol",placeholder:"ie 12C",style:"width:7em",value:a.Symbol,oninput:m.withAttr("value",a.changesymbol,a)})),e(D({label:"A",style:"width:7em",value:a.A,oninput:m.withAttr("value",a.changeA,a)})),e(D({label:"Z",style:"width:7em",value:a.Z,oninput:m.withAttr("value",a.changeZ,a)})),e(D({label:"Q",style:"width:7em",value:a.Q,oninput:m.withAttr("value",a.changeQ,a)}))]),m("div",{class:d.div_row},[e(D({label:"Energy [MeV/u]",style:"width:7em",value:a.T,oninput:m.withAttr("value",a.changeT,a)})),e(D({label:"Brho [Tm]",style:"width:7em",value:a.Brho,oninput:m.withAttr("value",a.changeBrho,a)})),e(D({label:m.trust("&#946;"),style:"width:7em",value:a.Beta,oninput:m.withAttr("value",a.changeBeta,a)})),e(D({label:m.trust("&#947;"),style:"width:7em",value:a.Gamma,oninput:m.withAttr("value",a.changeGamma,a)}))]),m("div",{class:d.div_row},[e(D({label:m.trust("p [MeV/c]"),style:"width:7em",value:a.P,oninput:m.withAttr("value",a.changeP,a)})),e(D({label:m.trust("n<sub>th</sub>"),style:"width:7em",value:a.Nth,oninput:m.withAttr("value",a.changeNth,a)}))]),m("div",{class:d.div_row},[m("ul",{class:d.ul},[m("li",{class:d.li},"mA = ",G.nuc.state.mA.toFixed(5)+" u"),m("li",{class:d.li},"A/Q = ",G.nuc.state.AoQ.toFixed(5)),i.hasOwnProperty("T")?m("li",{class:d.li},"half life = ",i.T):null,n.hasOwnProperty("Sn")?m("li",{class:d.li},"Sn = ",n.Sn.toFixed(3)+" MeV"):null,n.hasOwnProperty("Sp")?m("li",{class:d.li},"Sp = ",n.Sp.toFixed(3)+" MeV"):null,n.hasOwnProperty("S2n")?m("li",{class:d.li},"S2n = ",n.S2n.toFixed(3)+" MeV"):null,n.hasOwnProperty("S2p")?m("li",{class:d.li},"S2p = ",n.S2p.toFixed(3)+" MeV"):null,i.hasOwnProperty("M")?null:m("li",{class:d.li},"warning: Nucleus was not found in the AME16 database")])]),m("div",{class:d.div_row},v("Done",a.done,d.button_full))])};var R={view:function(t){var e=t.attrs.nucleus.state;return m("div",{class:d.div_column},[m("span",{class:d.h3},m.trust(e.Symbol+"<sup>"+e.Q+"+</sup>")),m("p",{class:"f5"},["T = ",e.T<.001?f(e.T.toPrecision(6)):e.T.toPrecision(6)," MeV/u",m("br"),m.trust("B&#961= "),e.Brho.toPrecision(6)," Tm",m("br"),"mA = ",e.mA.toFixed(5)," u",m("br"),"A/Q = ",e.AoQ.toFixed(4),m("br")]),p("Change","/nucchange")])}},H=!1;function Q(t){this.id=t.id||"catimaplot",this.values=t.values||[],this.specs={$schema:"https://vega.github.io/schema/vega-lite/v2.json",title:"",autosize:{type:"fit"},width:t.width||800,height:t.height||600,data:{values:this.values},selection:{grid:{type:"interval",bind:"scales"}},mark:t.mark||"circle",encoding:{x:{field:t.x||"",type:"quantitative",scale:{type:t.x_axis_type||"linear",zero:!1},axis:{title:t.x_label||""}},y:{field:t.y||"",type:"quantitative",scale:{type:t.y_axis_type||"linear",zero:!1},axis:{title:t.y_label||""}},color:{field:t.color||"",type:"nominal",legend:t.legend||null}}}}Q.prototype.set_values=function(t){this.specs.data.values=t},Q.prototype.set_width=function(t){this.specs.width=t},Q.prototype.set_height=function(t){this.specs.height=t},Q.prototype.set_title=function(t){this.specs.title=t},Q.prototype.set_x=function(t,e){this.specs.encoding.x.field=t,e&&this.set_x_label(e)},Q.prototype.set_x_label=function(t){this.specs.encoding.x.axis.title=t},Q.prototype.set_x_axis_type=function(t){this.specs.encoding.x.scale.type=t},Q.prototype.set_y_axis_type=function(t){this.specs.encoding.y.scale.type=t},Q.prototype.set_y=function(t,e){this.specs.encoding.y.field=t,e&&this.set_y_label(e)},Q.prototype.set_y_label=function(t){this.specs.encoding.y.axis.title=t},Q.prototype.set_color_field=function(t){this.specs.encoding.color.field=t},Q.prototype.set_legend_title=function(t){this.specs.encoding.color.legend.title=t},Q.prototype.show=function(){if(H)vegaEmbed("#"+this.id,this.specs,{mode:"vega-lite",actions:!1});else{var t=this;x(["https://cdn.jsdelivr.net/npm/vega@4.2.0","https://cdn.jsdelivr.net/npm/vega-lite@3.0.0-rc0","https://cdn.jsdelivr.net/npm/vega-embed@3.18.1"]).then(function(){return H=!0}).then(function(){vegaEmbed("#"+t.id,t.specs,{mode:"vega-lite",actions:!1})})}};var W={x:"energy",y:"dEdx",x_axis_type:"log",y_axis_type:"log",x_label:"Energy (MeV/u)",y_label:"dE/dx [MeV/g/cm2]",color:"material",legend:{}},J={values:[],status:"",reset:function(){J.fig=new Q(W),J.values=[],J.status=""},update:function(){J.fig.show()},sort:function(t){J.values=[],t.length<1||(t.forEach(function(t){for(var e=1;e<t.energy.length;e++){var a=t.Zm<201?k.a.GetSymbol(t.Am,t.Zm):l.a.Get(t.Zm).name;J.values.push({energy:t.energy[e],dEdx:t.dEdx[e],range:t.range[e],material:a})}}),J.fig.set_title("projectile: "+V.projectile.GetNucleusSymbol()),J.fig.set_values(J.values))},plot_options:[{value:"dEdx",name:"dEdx"},{value:"range",name:"Range"}],change_y_axis:function(t){"dEdx"==t&&(J.fig.specs.encoding.y.axis.title="dE/dx [MeV/g/cm2]",J.fig.specs.encoding.y.field=t,J.fig.specs.encoding.y.scale.type="log"),"range"==t&&(J.fig.specs.encoding.y.axis.title="range [g/cm2]",J.fig.specs.encoding.y.field=t,J.fig.specs.encoding.y.scale.type="log"),J.update()}},q={x:"th",y:"Eout",x_label:"thickness (g/cm2)",y_label:"Energy out (MeV/u)",color:"material"},U={values:[],status:"",reset:function(){U.fig=new Q(q),U.values=[],U.status=""},update:function(){U.fig.show()},matname:"",sort:function(t){if(U.values=[],1==t.length){for(var e=t[0],a=z.Eout_vs_thickness(e,V.projectile.state.T),i=0;i<a[0].length;i++){var n=e.Zm<201?k.a.GetSymbol(e.Am,e.Zm):l.a.Get(e.Zm).name;U.matname=n,U.values.push({th:a[0][i],Eout:a[1][i],Eloss:a[2][i],dEdx:a[3][i],material:n})}U.fig.set_values(U.values)}},plot_options:[{value:"Eout",name:"Energy after"},{value:"Eloss",name:"Energy loss"},{value:"dEdx",name:"dEdx"}],change_y_axis:function(t){"Eout"==t&&(U.fig.specs.title="material: "+U.matname+", projectile: "+V.projectile.GetNucleusSymbol()+", T = "+V.projectile.state.T.toPrecision(3)+"MeV/u",U.fig.specs.encoding.y.axis.title="Eout [MeV/u]",U.fig.specs.encoding.y.scale.type="linear",U.fig.specs.encoding.y.field=t),"Eloss"==t&&(U.fig.specs.title="material: "+U.matname+", projectile: "+V.projectile.GetNucleusSymbol()+", T = "+V.projectile.state.T.toPrecision(3)+"MeV/u",U.fig.specs.encoding.y.axis.title="Energy loss [MeV]",U.fig.specs.encoding.y.scale.type="linear",U.fig.specs.encoding.y.field=t),"dEdx"==t&&(U.fig.specs.title="material: "+U.matname+", projectile: "+V.projectile.GetNucleusSymbol()+", T = "+V.projectile.state.T.toPrecision(3)+"MeV/u",U.fig.specs.encoding.y.axis.title="dEdx [MeV/g/cm2]",U.fig.specs.encoding.y.scale.type="log",U.fig.specs.encoding.y.field=t),U.update()}},X={view:function(){return m("div",{class:d.div_column},[m("div",{class:d.form_element},[m("h1",{class:d.heading_medium},"Presets:"),s.map(function(t){return V.state.config.is_same(t.config)?v(t.name):m("a",{class:d.button_inverted,onclick:function(){V.state.config.set(t.config),V.clear_cache(),V.Save()}},t.name)})]),m("div",{class:d.form_element},p("Done","/"))])}},Y=function(){var t,e=document.createElement("tingle-test-transition"),a={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(t in a)if(void 0!==e.style[t])return a[t]}();function $(t){this.opts=function(){for(var t=1;t<arguments.length;t++)for(var e in arguments[t])arguments[t].hasOwnProperty(e)&&(arguments[0][e]=arguments[t][e]);return arguments[0]}({},{onClose:null,onOpen:null,beforeOpen:null,beforeClose:null,stickyFooter:!1,footer:!1,cssClass:[],closeLabel:"Close",closeMethods:["overlay","button","escape"]},t),this.init()}function K(){this.modalBoxFooter&&(this.modalBoxFooter.style.width=this.modalBox.clientWidth+"px",this.modalBoxFooter.style.left=this.modalBox.offsetLeft+"px")}$.prototype.init=function(){this.modal||(function(){this.modal=document.createElement("div"),this.modal.classList.add("tingle-modal"),(0===this.opts.closeMethods.length||-1===this.opts.closeMethods.indexOf("overlay"))&&this.modal.classList.add("tingle-modal--noOverlayClose");this.modal.style.display="none",this.opts.cssClass.forEach(function(t){"string"==typeof t&&this.modal.classList.add(t)},this),-1!==this.opts.closeMethods.indexOf("button")&&(this.modalCloseBtn=document.createElement("button"),this.modalCloseBtn.classList.add("tingle-modal__close"),this.modalCloseBtnIcon=document.createElement("span"),this.modalCloseBtnIcon.classList.add("tingle-modal__closeIcon"),this.modalCloseBtnIcon.innerHTML="Ã—",this.modalCloseBtnLabel=document.createElement("span"),this.modalCloseBtnLabel.classList.add("tingle-modal__closeLabel"),this.modalCloseBtnLabel.innerHTML=this.opts.closeLabel,this.modalCloseBtn.appendChild(this.modalCloseBtnIcon),this.modalCloseBtn.appendChild(this.modalCloseBtnLabel));this.modalBox=document.createElement("div"),this.modalBox.classList.add("tingle-modal-box"),this.modalBoxContent=document.createElement("div"),this.modalBoxContent.classList.add("tingle-modal-box__content"),this.modalBox.appendChild(this.modalBoxContent),-1!==this.opts.closeMethods.indexOf("button")&&this.modal.appendChild(this.modalCloseBtn);this.modal.appendChild(this.modalBox)}.call(this),function(){this._events={clickCloseBtn:this.close.bind(this),clickOverlay:function(t){-1!==this.opts.closeMethods.indexOf("overlay")&&!function(t,e){for(;(t=t.parentElement)&&!t.classList.contains(e););return t}(t.target,"tingle-modal")&&t.clientX<this.modal.clientWidth&&this.close()}.bind(this),resize:this.checkOverflow.bind(this),keyboardNav:function(t){-1!==this.opts.closeMethods.indexOf("escape")&&27===t.which&&this.isOpen()&&this.close()}.bind(this)},-1!==this.opts.closeMethods.indexOf("button")&&this.modalCloseBtn.addEventListener("click",this._events.clickCloseBtn);this.modal.addEventListener("mousedown",this._events.clickOverlay),window.addEventListener("resize",this._events.resize),document.addEventListener("keydown",this._events.keyboardNav)}.call(this),document.body.insertBefore(this.modal,document.body.firstChild),this.opts.footer&&this.addFooter())},$.prototype.destroy=function(){null!==this.modal&&(function(){-1!==this.opts.closeMethods.indexOf("button")&&this.modalCloseBtn.removeEventListener("click",this._events.clickCloseBtn);this.modal.removeEventListener("mousedown",this._events.clickOverlay),window.removeEventListener("resize",this._events.resize),document.removeEventListener("keydown",this._events.keyboardNav)}.call(this),this.modal.parentNode.removeChild(this.modal),this.modal=null)},$.prototype.open=function(){var t=this;"function"==typeof t.opts.beforeOpen&&t.opts.beforeOpen(),this.modal.style.removeProperty?this.modal.style.removeProperty("display"):this.modal.style.removeAttribute("display"),this._scrollPosition=window.pageYOffset,document.body.classList.add("tingle-enabled"),document.body.style.top=-this._scrollPosition+"px",this.setStickyFooter(this.opts.stickyFooter),this.modal.classList.add("tingle-modal--visible"),Y?this.modal.addEventListener(Y,function e(){"function"==typeof t.opts.onOpen&&t.opts.onOpen.call(t),t.modal.removeEventListener(Y,e,!1)},!1):"function"==typeof t.opts.onOpen&&t.opts.onOpen.call(t),this.checkOverflow()},$.prototype.isOpen=function(){return!!this.modal.classList.contains("tingle-modal--visible")},$.prototype.close=function(){if("function"==typeof this.opts.beforeClose&&!this.opts.beforeClose.call(this))return;document.body.classList.remove("tingle-enabled"),window.scrollTo(0,this._scrollPosition),document.body.style.top=null,this.modal.classList.remove("tingle-modal--visible");var t=this;Y?this.modal.addEventListener(Y,function e(){t.modal.removeEventListener(Y,e,!1),t.modal.style.display="none","function"==typeof t.opts.onClose&&t.opts.onClose.call(this)},!1):(t.modal.style.display="none","function"==typeof t.opts.onClose&&t.opts.onClose.call(this))},$.prototype.setContent=function(t){"string"==typeof t?this.modalBoxContent.innerHTML=t:(this.modalBoxContent.innerHTML="",this.modalBoxContent.appendChild(t)),this.isOpen()&&this.checkOverflow()},$.prototype.getContent=function(){return this.modalBoxContent},$.prototype.addFooter=function(){(function(){this.modalBoxFooter=document.createElement("div"),this.modalBoxFooter.classList.add("tingle-modal-box__footer"),this.modalBox.appendChild(this.modalBoxFooter)}).call(this)},$.prototype.setFooterContent=function(t){this.modalBoxFooter.innerHTML=t},$.prototype.getFooterContent=function(){return this.modalBoxFooter},$.prototype.setStickyFooter=function(t){this.isOverflow()||(t=!1),t?this.modalBox.contains(this.modalBoxFooter)&&(this.modalBox.removeChild(this.modalBoxFooter),this.modal.appendChild(this.modalBoxFooter),this.modalBoxFooter.classList.add("tingle-modal-box__footer--sticky"),K.call(this),this.modalBoxContent.style["padding-bottom"]=this.modalBoxFooter.clientHeight+20+"px"):this.modalBoxFooter&&(this.modalBox.contains(this.modalBoxFooter)||(this.modal.removeChild(this.modalBoxFooter),this.modalBox.appendChild(this.modalBoxFooter),this.modalBoxFooter.style.width="auto",this.modalBoxFooter.style.left="",this.modalBoxContent.style["padding-bottom"]="",this.modalBoxFooter.classList.remove("tingle-modal-box__footer--sticky")))},$.prototype.addFooterBtn=function(t,e,a){var i=document.createElement("button");return i.innerHTML=t,i.addEventListener("click",a),"string"==typeof e&&e.length&&e.split(" ").forEach(function(t){i.classList.add(t)}),this.modalBoxFooter.appendChild(i),i},$.prototype.resize=function(){console.warn("Resize is deprecated and will be removed in version 1.0")},$.prototype.isOverflow=function(){var t=window.innerHeight;return this.modalBox.clientHeight>=t},$.prototype.checkOverflow=function(){this.modal.classList.contains("tingle-modal--visible")&&(this.isOverflow()?this.modal.classList.add("tingle-modal--overflow"):this.modal.classList.remove("tingle-modal--overflow"),!this.isOverflow()&&this.opts.stickyFooter?this.setStickyFooter(!1):this.isOverflow()&&this.opts.stickyFooter&&(K.call(this),this.setStickyFooter(!0)))};var tt={};tt.modal=new $({footer:!0,closeLabel:"Close"}),tt.modal.addFooterBtn("Close","tingle-btn",function(){tt.modal.close()}),tt.set_content=function(t){tt.modal.setContent(t)},tt.open=function(){tt.modal.open()},tt.close=function(){tt.modal.close()};var et=a(6),at={result:{},matter_names:[],done:!0,prepare:function(){var t=j.vm.layers;at.matter=j.vm.layers;for(var e=0;e<t.length;e++)at.matter_names.push(t[e].name)},prepareoutput:function(t){if(t.result&&(t.result.sigma_a=1e3*t.result.sigma_a),t.partial)for(var e in t.partial)t.partial[e].sigma_a=1e3*t.partial[e].sigma_a},getResult:function(){if(!(V.datavalid&&V.result&&at.done)||V.result.error){at.result={},at.matter_names=[],at.done=!1,at.prepare();var t=z.prepare();z.calculate(t).then(function(t){if(!t.result||t.error)return at.done=!0,V.clear_cache(),at.result={error:"Failed to retrieve data from Atima Server"},void m.redraw();if(at.done=!0,V.datavalid=!0,at.prepareoutput(t),at.result=t,t.result&&(at.result.result.Brho=et.a.brho_from_T(t.result.Eout,t.projectile.A,t.projectile.Z).toPrecision(6),at.result.result.Beta=et.a.beta_from_T(t.result.Eout).toPrecision(6)),t.partial&&t.partial.length>0)for(var e=0;e<t.partial.length;e++)at.result.partial[e].Brho=et.a.brho_from_T(t.partial[e].Eout,t.projectile.A,t.projectile.Z).toPrecision(6),at.result.partial[e].Beta=et.a.beta_from_T(t.partial[e].Eout).toPrecision(6);V.result=at.result,m.redraw()},function(){at.done=!0,V.clear_cache(),at.result={error:"Failed to retrieve data from Atima Server"},V.report("Failed to retrieve data from Atima Server"),m.redraw()}).catch(function(t){V.report(t)})}},save_file:function(){if(at.result.result&&at.result.partial){var t=at.result.result,e="Projectile: "+V.projectile.state.Symbol+" @ "+t.Ein.toFixed(3)+"MeV/u";e+="\r\n\r\nTotal Results\n-------------",e+="\r\nEout = "+t.Eout.toFixed(3)+" MeV/u",e+="\r\nEloss = "+t.Eloss.toFixed(3)+"MeV",e+="\r\nBrho = "+t.Brho+"Tm",e+="\r\nBeta = "+t.Beta,e+="\r\nsigma_E = "+t.sigma_E.toFixed(3)+"MeV/u",e+="\r\nsigma_a = "+t.sigma_a.toFixed(3)+"mrad",e+="\r\nTOF = "+t.tof.toFixed(6)+" ns",e+="\r\n",e+="\r\nPartial Results\n---------------";for(var a=0;a<at.result.partial.length;a++)t=at.result.partial[a],e+="\r\n",e+="\r\n",e+="***** "+at.matter[a].name+" *****",e+="\r\nmaterial: "+at.matter[a].symbol,e+="\r\nthickness: "+at.matter[a].th+" mg/cm2",e+="\r\nEin = "+t.Ein.toFixed(3)+" MeV/u",e+="\r\nEout = "+t.Eout.toFixed(3)+" MeV/u",e+="\r\nBrho = "+t.Brho+" Tm",e+="\r\nBeta = "+t.Beta+" ",e+="\r\nEloss = "+t.Eloss.toFixed(2)+" MeV",e+="\r\nsigma_E = "+t.sigma_E.toFixed(3)+" MeV/u",e+="\r\nsigma_a = "+t.sigma_a.toFixed(2)+" mrad",e+="\r\nrange = "+t.range.toFixed(3)+" g/cm2",e+="\r\nsigma_r = "+t.sigma_r.toFixed(2)+" g/cm2",e+="\r\ndEdxi = "+t.dEdxi.toFixed(3)+" MeV/g/cm2",e+="\r\nTOF = "+t.tof.toFixed(4)+" ns";y(e,"webatima_result_"+V.projectile.state.Symbol)}}},it={oninit:function(){at.getResult()},TotalTemplate:function(){var t=function(t){return t<.01?t.toExponential(4):t.toFixed(4)},e=at.result;return e.result?m("div",{class:d.div_row},[m("div",{class:d.div_cell_100},[m("p","Projectile: ",V.projectile.state.Symbol+" @ "+t(e.result.Ein)+"MeV/u")]),m("div",{class:d.div_cell_auto},[m("p",m.trust("E<sub>out</sub>")," = ",e.result.Eout.toFixed(4)," MeV/u"),m("p",m.trust("B&#961")," = ",e.result.Brho," Tm"),m("p",m.trust("&#946")," = ",e.result.Beta)]),m("div",{class:d.div_cell_auto},[m("p",m.trust("E<sub>loss</sub>")," = ",t(e.result.Eloss)," MeV"),m("p",m.trust("&#963<sub>E</sub>")," = ",t(e.result.sigma_E)," MeV/u"),m("p",m.trust("TOF")," = ",e.result.tof.toFixed(6)," ns")]),m("div",{class:d.div_cell_auto},[e.result.Eout>0?m("p",m.trust("&#963<sub>p</sub>/p = "),et.a.relative_momentum_deviation(e.result.sigma_E,e.result.Eout).toExponential(3)):null,m("p",m.trust("&#963<sub>a</sub>")," = ",t(e.result.sigma_a)," mrad")]),e.result.hasOwnProperty("sp")?m("div",{class:d.div_cell_auto},[m("p","Reaction rate: ",e.result.sp>=0&&e.result.sp<=1?(1-e.result.sp).toFixed(3):"N/A")]):null]):null},PartialTemplate:function(){var t=function(t){return t<.01?t.toExponential(3):t.toFixed(3)},e=at.result;return e.partial?m("div",{style:"overflow-x:auto;"},[m("table",{class:d.table},[m("thead",m("tr",{class:d.thead_tr},[m("th",{class:d.th},"#"),m("th",{class:d.th},"name"),m("th",{class:d.th},m.trust("E<sub>in</sub><br>(MeV/u)")),m("th",{class:d.th},m.trust("E<sub>out</sub><br>(MeV/u)")),m("th",{class:d.th},m.trust("E<sub>loss</sub><br>(MeV)")),m("th",{class:d.th},m.trust("&#963<sub>E</sub><br>(MeV/u)")),m("th",{class:d.th},m.trust("&#963<sub>a</sub><br>(mrad)")),m("th",{class:d.th},m.trust("range<br>(g/cm<sup>2</sup>)")),m("th",{class:d.th},m.trust("&#963<sub>r</sub><br>(g/cm<sup>2</sup>)")),m("th",{class:d.th},m.trust("dE<sub>in</sub>/dx<br>(MeV/(g/cm<sup>2</sup>))")),m("th",{class:d.th},m.trust("tof<br>(ns)")),m("th",{class:d.th},m.trust("Reaction<br>rate")),m("th",{class:d.th},m.trust("d/R")),m("th",{class:d.th},m.trust("W<sub>e</sub>")),m("th",{class:d.th},m.trust("W<sub>p</sub>"))])),m("tbody",e.partial.map(function(e,a){var i="Brho = "+(e.Brho+"  Tm")+"\nBeta = "+e.Beta,n="material: "+at.matter[a].symbol+"\nl = "+at.matter[a].l+" cm\nth. = "+at.matter[a].th+" mg/cm2\ndensity = "+at.matter[a].rho+" g/cm3";return m("tr",{class:d.tr},[m("td",{class:d.td},a),m("td",{class:d.td,title:n},at.matter[a].name),m("td",{class:d.td},t(e.Ein)),m("td",{class:d.td,title:i},t(e.Eout)),m("td",{class:d.td},t(e.Eloss)),m("td",{class:d.td},t(e.sigma_E)),m("td",{class:d.td},t(e.sigma_a)),m("td",{class:d.td},t(e.range)),m("td",{class:d.td},t(e.sigma_r)),m("td",{class:d.td},t(e.dEdxi)),m("td",{class:d.td},t(e.tof)),m("td",{class:d.td},e.sp&&e.sp>=0&&e.sp<=1?(1-e.sp).toFixed(3):"N/A"),m("td",{class:d.td},e.range>0?t(.001*at.matter[a].th/e.range):""),m("td",{class:d.td},e.we&&e.we>0?t(e.we):""),m("td",{class:d.td},e.wp&&e.wp>0?t(e.wp):"")])}))])]):null},view:function(){var t=at.result;return at.done?t.error?g("Error: "+t.error):t.result?m("div",[m("div",{class:d.h3},"Results"),m("div",{class:d.div_cell_100},m(F,{title:"Total Results",content:it.TotalTemplate()})),m("div",{class:d.div_cell_100},m(F,{title:"Partial Results",content:it.PartialTemplate()})),m("div",{class:d.div_cell_100},[t.id?v("Share Link",function(){var e='<div><label>Link:<input class="w-100" type="text" value="'+(window.location.origin+window.location.pathname+"?c="+t.id)+'"></input></label></div>';tt.set_content(e),tt.open()}):null,v("Save Data",function(){try{at.save_file()}catch(t){console.log(t)}})])]):g("Error: Could not find results"):m("span","Loading...")}},nt=a(14),st={projectile:"",energy:"",target:"",fragment:"",cs:-1,sigma_p:-1,p:-1,momentum_deviation:-1,clear:function(){st.cs=-1,st.sigma_p=-1,st.p=-1,st.momentum_deviation=-1}};st.calculate=h(function(){if(!(st.projectile.length<2||st.target.length<2||st.fragment.length<2)){var t,e=(t=k.a.GetNuc(st.projectile))[0],a=t[1],i=(t=k.a.GetNuc(st.target))[0],n=t[1],s=(t=k.a.GetNuc(st.fragment))[0],o=t[1];if(st.clear(),!(e<=0||s<=0||i<=0||isNaN(e)||isNaN(a)||isNaN(i)||isNaN(n)||isNaN(s)||isNaN(o)||e<a||s<o||i<n||e<=s)){st.projectile=k.a.GetSymbol(e,a),st.target=k.a.GetSymbol(i,n),st.fragment=k.a.GetSymbol(s,o),st.cs=Object(nt.a)(e,a,i,n,s,o).toFixed(3);var l=parseFloat(st.energy);isNaN(l)||(st.sigma_p=Object(nt.b)(e,s),st.p=et.a.p_from_T(l,s),st.momentum_deviation=st.sigma_p/st.p,m.redraw())}}},250);var ot={};if(ot.input_function=function(t,e,a){return m("label",{class:d.label},[t+":",m("input",{type:"text",style:"width:7em;",cplaceholder:a,value:e[t],oninput:function(a){a.redraw=!1,e[t]=a.currentTarget.value,e.calculate()}})])},ot.oninit=function(){st.clear(),st.projectile=V.projectile.state.Symbol,st.energy=V.projectile.state.T,st.target.length>2&&st.fragment.length>2&&st.calculate()},ot.view=function(){var t=st,e=parseFloat(t.cs),a=parseFloat(t.energy),i=parseFloat(t.momentum_deviation),n=parseFloat(t.p);return console.log(st),[m("h3",{class:d.h3},"EPAX v3 + Goldhaber"),m("div",{class:d.div_row_centered},[ot.input_function("projectile",t,"e.g. 12C"),ot.input_function("target",t,"e.g 9Be"),ot.input_function("fragment",t,"e.g. 11C")]),m("div",{class:d.div_row_centered},[ot.input_function("energy",t,"in MeV/u"),"MeV/u",!isNaN(n)&&n>0?" = "+t.p.toFixed(1)+" MeV/c":null]),m("div",{class:d.div_row_centered},[isNaN(e)||e<=0?null:m("div",{class:d.div_cell_100},m.trust("&sigma; = "+t.cs+" mb")),isNaN(a)||i<0||isNaN(i)?null:m("div",{class:d.div_cell_100},[m.trust("&#963<sub>p</sub> / p = "),t.momentum_deviation.toPrecision(4)])])]},"undefined"==typeof m)throw alert("failed to load ui library"),document.getElementById("loading").innerHTML="Failed to load ui library, probably old browser or network problem",new Error("failed to load ui library");function lt(){return V.state.config.is_same(i)?V.info="setting: ATIMA v1.3":V.state.config.is_same(n)?V.info="setting: ATIMA v1.4":V.info="setting: custom",m("footer",{class:d.footer},m("span",{style:"color:#666",class:"f7"},V.info))}function rt(t){return m("nav",{class:d.nav},t)}Z.a.config("https://e64a8b51d35b4bddadf17a24eda759ce@sentry.io/1249356").install(),V.CheckBrowser()||alert("Some browser features were not detected, please use modern browser, otherwise this application may not work properly.");var ct=function(){var t="db white fw6 mt4 pointer link";return m("div",{id:"offside",class:"dn pt3 mw5-ns w-30-ns w-100 h-100 bg-black z-1 fixed top-0 left-0 overflow-x-hidden tc"},[m("a",{class:"db white fw5 pointer",onclick:function(){document.getElementById("offside").classList.toggle("dn")}},m.trust('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" style="fill:#ffffff"/></svg>')),_({class:t,title:"Load",id:"apploader"},V.LoadJSONFile),m("a",{class:t,onclick:function(){y(V.state,"webatima_input.json")}},"Save"),m("div",{class:"dropdown db white fw6 mt4 pointer link",onclick:function(t){t.preventDefault()}},"Tools",m("div",{class:"dropdown-content bg-dark-gray white fw6 dn relative z-1 shadow-4 w-100 pa2"},[m("a",{class:"db pa2 dim fw3",onclick:function(){m.route.set("/epax")}},"Fragmentation")])),m("a",{class:t,onclick:function(t){m.route.set("/config"),t.preventDefault()}},"Settings"),m("a",{class:t,href:"about.html",target:"_blank"},"About")])},dt=function(){return[m("a",{class:d.nav_item_small,onclick:function(){document.getElementById("offside").classList.toggle("dn")}},m.trust('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path d="M0 0h24v24H0z" fill="none"/><path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z" style="fill:#ffffff"/></svg>')),m("a",{class:d.nav_item,onclick:function(){y(V.state,"webatima_input.json")}},"Save"),_({class:d.nav_item,title:"Load",id:"apploader"},V.LoadJSONFile),m("a",{class:d.nav_item_right,href:"about.html",target:"_blank"},"About"),m("a",{class:d.nav_item_right,onclick:function(t){m.route.set("/config"),t.preventDefault()}},"Settings"),m("div",{class:d.dropdown,onclick:function(t){t.preventDefault()}},"Tools",m("div",{class:d.dropdown_content},[m("a",{class:"db pa2 dim fw3",onclick:function(){m.route.set("/epax")}},"Fragmentation")]))]},ut=function(){return[m("div",{class:d.nav_item_sticky,onclick:function(t){m.route.set("/"),t.preventDefault()}},"Back")]},mt={oninit:function(){},view:function(){return[m("div",{class:d.container_narrow},[rt(dt()),m("div",{class:d.combine([d.div_row,d.padding_vertical,"justify-center"])},[m("div",{class:d.div_cell_20a},m(F,{title:"Projectile",content:m(R,{nucleus:V.projectile})})),m("div",{class:d.div_cell_80},m(F,{title:"Matter",content:m(j)}))]),m("div",{class:d.combine([d.div_row,d.padding_vertical])},m("div",{class:d.div_cell_100},[m("h2","Results"),m("a",{class:d.button_full,onclick:function(){-1==j.vm.editindex&&m.route.set("/results")}},"Calculate")])),ct()]),lt()]}},ht={view:function(){return m("div",{class:d.container_narrow},[rt(ut()),m(G)])}},pt={};pt.view=function(){if(V.loaded)return[m("div",{class:d.container},[rt([m("a",{class:d.nav_item_sticky,onclick:function(t){m.route.set("/"),t.preventDefault()}},"Back"),m("a",{class:d.nav_item_sticky,onclick:function(t){m.route.set("/nucchange"),t.preventDefault()}},"Projectile")]),m(it)]),lt()];m.route.set("/")};var vt={oninit:function(t){t.state.plotdata=J},oncreate:function(t){t.state.plotdata.reset(),z.get_data(z.prepare(!0)).then(function(e){e.length>0?(t.state.plotdata.sort(e),m.redraw(),t.state.plotdata.update()):t.state.plotdata.status="failed"}).catch(function(t){V.report(t)})},view:function(t){if(V.loaded)return m("div",{class:d.container},[rt(ut()),m(N,t.state.plotdata)]);m.route.set("/")}},ft={oninit:function(t){t.state.plotdata=U},oncreate:function(t){t.state.plotdata.reset();var e=V.get_editindex();e<0||z.get_data(z.prepare_one(e)).then(function(e){e.length>0?(t.state.plotdata.sort(e),m.redraw(),t.state.plotdata.change_y_axis("Eout")):t.state.plotdata.status="failed"}).catch(function(t){V.report(t)})},view:function(t){if(V.loaded)return m("div",{class:d.container},[rt(ut()),m(N,t.state.plotdata)]);m.route.set("/")}},gt={view:function(){return m("div",{class:d.container_narrow},[rt(ut()),m(X)])}},yt={view:function(){return m("div",{class:d.container_narrow},[rt(ut()),m(ot)])}};Z.a.context(function(){document.getElementById("loading").innerHTML=loader("loading");var t=window.location.search,e=t.indexOf("?c=");if(t.length>3&&e>-1){var a=t.length;"/"==t.charAt(a-1)&&(a-=1);var i=t.substring(e+3,a);V.load_config(i)}else{var n=P.a.load("state");V.Load(n)}m.route(document.getElementById("NS"),"/",{"/":mt,"/nucchange":ht,"/results":pt,"/plot":vt,"/materialplot":ft,"/config":gt,"/epax":yt})})}}]);
//# sourceMappingURL=index_13ea8fe88a0774236352.js.map