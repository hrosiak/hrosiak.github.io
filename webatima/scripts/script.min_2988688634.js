var $jscomp=$jscomp||{};$jscomp.scope={};$jscomp.ASSUME_ES5=!1;$jscomp.ASSUME_NO_NATIVE_MAP=!1;$jscomp.ASSUME_NO_NATIVE_SET=!1;$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(a,b,c){a!=Array.prototype&&a!=Object.prototype&&(a[b]=c.value)};$jscomp.getGlobal=function(a){return"undefined"!=typeof window&&window===a?a:"undefined"!=typeof global&&null!=global?global:a};$jscomp.global=$jscomp.getGlobal(this);$jscomp.SYMBOL_PREFIX="jscomp_symbol_";
$jscomp.initSymbol=function(){$jscomp.initSymbol=function(){};$jscomp.global.Symbol||($jscomp.global.Symbol=$jscomp.Symbol)};$jscomp.Symbol=function(){var a=0;return function(b){return $jscomp.SYMBOL_PREFIX+(b||"")+a++}}();
$jscomp.initSymbolIterator=function(){$jscomp.initSymbol();var a=$jscomp.global.Symbol.iterator;a||(a=$jscomp.global.Symbol.iterator=$jscomp.global.Symbol("iterator"));"function"!=typeof Array.prototype[a]&&$jscomp.defineProperty(Array.prototype,a,{configurable:!0,writable:!0,value:function(){return $jscomp.arrayIterator(this)}});$jscomp.initSymbolIterator=function(){}};$jscomp.arrayIterator=function(a){var b=0;return $jscomp.iteratorPrototype(function(){return b<a.length?{done:!1,value:a[b++]}:{done:!0}})};
$jscomp.iteratorPrototype=function(a){$jscomp.initSymbolIterator();a={next:a};a[$jscomp.global.Symbol.iterator]=function(){return this};return a};$jscomp.makeIterator=function(a){$jscomp.initSymbolIterator();var b=a[Symbol.iterator];return b?b.call(a):$jscomp.arrayIterator(a)};
$jscomp.polyfill=function(a,b,c,d){if(b){c=$jscomp.global;a=a.split(".");for(d=0;d<a.length-1;d++){var e=a[d];e in c||(c[e]={});c=c[e]}a=a[a.length-1];d=c[a];b=b(d);b!=d&&null!=b&&$jscomp.defineProperty(c,a,{configurable:!0,writable:!0,value:b})}};$jscomp.FORCE_POLYFILL_PROMISE=!1;
$jscomp.polyfill("Promise",function(a){function b(){this.batch_=null}function c(a){return a instanceof e?a:new e(function(b,c){b(a)})}if(a&&!$jscomp.FORCE_POLYFILL_PROMISE)return a;b.prototype.asyncExecute=function(a){null==this.batch_&&(this.batch_=[],this.asyncExecuteBatch_());this.batch_.push(a);return this};b.prototype.asyncExecuteBatch_=function(){var a=this;this.asyncExecuteFunction(function(){a.executeBatch_()})};var d=$jscomp.global.setTimeout;b.prototype.asyncExecuteFunction=function(a){d(a,
0)};b.prototype.executeBatch_=function(){for(;this.batch_&&this.batch_.length;){var a=this.batch_;this.batch_=[];for(var b=0;b<a.length;++b){var c=a[b];delete a[b];try{c()}catch(k){this.asyncThrow_(k)}}}this.batch_=null};b.prototype.asyncThrow_=function(a){this.asyncExecuteFunction(function(){throw a;})};var e=function(a){this.state_=0;this.result_=void 0;this.onSettledCallbacks_=[];var b=this.createResolveAndReject_();try{a(b.resolve,b.reject)}catch(h){b.reject(h)}};e.prototype.createResolveAndReject_=
function(){function a(a){return function(d){c||(c=!0,a.call(b,d))}}var b=this,c=!1;return{resolve:a(this.resolveTo_),reject:a(this.reject_)}};e.prototype.resolveTo_=function(a){if(a===this)this.reject_(new TypeError("A Promise cannot resolve to itself"));else if(a instanceof e)this.settleSameAsPromise_(a);else{a:switch(typeof a){case "object":var b=null!=a;break a;case "function":b=!0;break a;default:b=!1}b?this.resolveToNonPromiseObj_(a):this.fulfill_(a)}};e.prototype.resolveToNonPromiseObj_=function(a){var b=
void 0;try{b=a.then}catch(h){this.reject_(h);return}"function"==typeof b?this.settleSameAsThenable_(b,a):this.fulfill_(a)};e.prototype.reject_=function(a){this.settle_(2,a)};e.prototype.fulfill_=function(a){this.settle_(1,a)};e.prototype.settle_=function(a,b){if(0!=this.state_)throw Error("Cannot settle("+a+", "+b|"): Promise already settled in state"+this.state_);this.state_=a;this.result_=b;this.executeOnSettledCallbacks_()};e.prototype.executeOnSettledCallbacks_=function(){if(null!=this.onSettledCallbacks_){for(var a=
this.onSettledCallbacks_,b=0;b<a.length;++b)a[b].call(),a[b]=null;this.onSettledCallbacks_=null}};var f=new b;e.prototype.settleSameAsPromise_=function(a){var b=this.createResolveAndReject_();a.callWhenSettled_(b.resolve,b.reject)};e.prototype.settleSameAsThenable_=function(a,b){var c=this.createResolveAndReject_();try{a.call(b,c.resolve,c.reject)}catch(k){c.reject(k)}};e.prototype.then=function(a,b){function c(a,b){return"function"==typeof a?function(b){try{d(a(b))}catch(t){f(t)}}:b}var d,f,g=new e(function(a,
b){d=a;f=b});this.callWhenSettled_(c(a,d),c(b,f));return g};e.prototype.catch=function(a){return this.then(void 0,a)};e.prototype.callWhenSettled_=function(a,b){function c(){switch(d.state_){case 1:a(d.result_);break;case 2:b(d.result_);break;default:throw Error("Unexpected state: "+d.state_);}}var d=this;null==this.onSettledCallbacks_?f.asyncExecute(c):this.onSettledCallbacks_.push(function(){f.asyncExecute(c)})};e.resolve=c;e.reject=function(a){return new e(function(b,c){c(a)})};e.race=function(a){return new e(function(b,
d){for(var e=$jscomp.makeIterator(a),f=e.next();!f.done;f=e.next())c(f.value).callWhenSettled_(b,d)})};e.all=function(a){var b=$jscomp.makeIterator(a),d=b.next();return d.done?c([]):new e(function(a,e){function f(b){return function(c){g[b]=c;h--;0==h&&a(g)}}var g=[],h=0;do g.push(void 0),h++,c(d.value).callWhenSettled_(f(g.length-1),e),d=b.next();while(!d.done)})};return e},"es6","es3");
$jscomp.iteratorFromArray=function(a,b){$jscomp.initSymbolIterator();a instanceof String&&(a+="");var c=0,d={next:function(){if(c<a.length){var e=c++;return{value:b(e,a[e]),done:!1}}d.next=function(){return{done:!0,value:void 0}};return d.next()}};d[Symbol.iterator]=function(){return d};return d};$jscomp.polyfill("Array.prototype.values",function(a){return a?a:function(){return $jscomp.iteratorFromArray(this,function(a,c){return c})}},"es8","es3");
var ElementDensity=function(){element_density=[0,8.3748E-5,1.66322E-4,.534,1.848,2.37,2,.0011652,.00133151,.00158029,8.38505E-4,.971,1.74,2.699,2.33,2.2,2,.00299473,.00166201,.862,1.55,2.989,4.54,6.11,7.18,7.44,7.874,8.9,8.902,8.96,7.133,5.904,5.323,5.73,4.5,3.1028,.00347832,1.532,2.54,4.469,6.506,8.57,10.22,11.5,12.41,12.41,12.02,10.5,8.65,7.31,7.31,6.691,6.24,4.93,.00548536,1.873,3.5,6.154,6.657,6.71,6.9,7.22,7.46,5.243,7.9004,8.229,8.55,8.795,9.066,9.321,6.73,9.84,13.31,16.654,19.3,21.02,22.57,
22.42,21.45,19.32,13.546,11.72,11.35,9.747,9.32,9.32,.00900662,1,5,10.07,11.72,15.37,18.95,20.25,19.84,13.67,13.51,14,10];return{GetDensity:function(a){return 1>a||98<a?0:element_density[a]}}}(),ElementMass=function(){element_mass=[0,1.00794,4.0026,6.941,9.01218,10.811,12.0107,14.0067,15.9994,18.9984,20.1797,22.9898,24.305,26.9815,28.0855,30.9738,32.065,35.453,39.948,39.0983,40.078,44.9559,47.867,50.9415,51.9961,54.938,55.845,58.9332,58.6934,63.546,65.409,69.723,72.64,74.9216,78.96,79.904,83.798,
85.4678,87.62,88.9059,91.224,92.9064,95.94,97.9072,101.07,102.906,106.42,107.868,112.411,114.818,118.71,121.76,127.6,126.904,131.293,132.905,137.327,138.905,140.116,140.908,144.24,144.913,150.36,151.964,157.25,158.925,162.5,164.93,167.259,168.934,173.04,174.967,178.49,180.948,183.84,186.207,190.23,192.217,195.078,196.967,200.59,204.383,207.2,208.98,208.982,209.987,222.018,223.02,226.025,227.028,232.038,231.036,238.029,237.048,244.064,243.061,247.07,247.07,251.08,252.083,257.095,258.098,259.101,262.11,
261.109,262.114,266.122,264.125,269.134,268.139];return{GetMass:function(a){return 1>a||109<a?0:element_mass[a]}}}(),MOCADI_Matter=function(){var a={201:{key:"Plastics",density:1.032,Ipot:64.7,name:"plastics - BC400",c:{H:.085292,C:.914708}},202:{key:"Air",density:.001205,Ipot:85.7,c:{N:.755267,O:.231781,Ar:.012827,C:1.24E-4}},203:{key:"CH2",density:.94,c:{C:.856281,H:.143719}},204:{key:"lH2",density:.0708,c:{H:1}},205:{key:"lD2",density:.162,c:{"2H":1}},206:{key:"H2O",density:1,Ipot:78,name:"Water",
c:{H:.111898,O:.888102}},207:{key:"Diamond",density:3.52,c:{C:1}},208:{key:"Glass",density:2.4,c:{Si:.37722,O:.539562,B:.040064,Na:.028191,Al:.011644,K:.003321}},209:{key:"ALMG3",density:2.67,c:{Al:.97,Mg:.03}},210:{key:"ArCO2_30",density:.00171,c:{Ar:.679,O:.2321,C:.0889}},211:{key:"CF4",density:.00372,c:{C:.136479,F:.863521}},212:{key:"C4H10",density:.00251,Ipot:48.3,name:"Isobutane",c:{C:.826583,H:.173417}},213:{key:"Kapton",density:1.42,Ipot:79.6,c:{H:.026362,C:.691133,N:.07327,O:.209235}},214:{key:"Mylar",
density:1.38,Ipot:78.7,c:{C:.62501,H:.041961,O:.333029}},215:{key:"NaF",density:2.56,name:"Sodium fluoride",c:{Na:.54753,F:.45247}},216:{key:"P10",density:.00166,c:{Ar:.64171,C:.268247,H:.09004}},217:{key:"Polyolefin",density:.9,c:{O:.888102,H:.111898}},218:{key:"CmO2",density:12,c:{Cm:.885337,O:.114663}},219:{key:"Suprasil",density:2.2,c:{Si:.37722,O:.539562,B:.040064,Na:.028191,Al:.011644,K:.003321}},220:{key:"HAVAR",density:8.3,c:{Co:.403228,Cr:.169412,Ni:.124301,W:.089847,Mo:.031259,Fe:.181952}},
221:{key:"Steel",density:8,c:{Fe:.74621,Cr:.169,Ni:.08479}},222:{key:"CO2",density:.001842,Ipot:85,name:"Carbon dioxide",c:{C:.272912,O:.727088}},223:{key:"CH4",density:6E-4,Ipot:41.7,name:"Methane",c:{H:.251318,C:.748682}},224:{key:"CH3OH",density:.792,Ipot:67.6,name:"Methanol",c:{H:.125828,C:.374844,O:.499328}},225:{key:"C3H6O",density:.7899,Ipot:64.2,name:"Acetone",c:{H:.104128,C:.620397,O:.275476}},226:{key:"C2H2",density:.0010967,Ipot:58.2,name:"Acetylene",c:{H:.077423,C:.922577}},227:{key:"C5H5N5",
density:1.35,Ipot:71.4,name:"Adenine",c:{H:.037296,C:.444424,N:.51828}},228:{key:"Adipose_Tissue",density:.92,Ipot:63.2,name:"Adipose_Tissue ICRP",c:{H:.119477,C:.63724,N:.00797,O:.232333,Na:5E-4,Mg:2E-5,P:1.6E-4,S:7.3E-4,Cl:.00119,K:3.2E-4,Ca:2E-5,Fe:2E-5,Zn:2E-5}},229:{key:"C3H7NO2",density:1.42,Ipot:71.9,name:"Alanine",c:{H:.079193,C:.404432,N:.157214,O:.359161}},230:{key:"Bakelite",density:1.25,Ipot:72.4,c:{H:.057441,C:.774591,O:.167968}},231:{key:"AgBr",density:6.473,Ipot:486.6,name:"Silver Bromide",
c:{Ag:.574463,Br:.425537}},232:{key:"AgCl",density:5.56,Ipot:398.4,name:"Silver Chloride",c:{Ag:.752633,Cl:.247367}},233:{key:"AgI",density:5.675,Ipot:543.5,name:"Silver Iodide",c:{Ag:.459458,I:.540542}},234:{key:"Al2O3",density:3.97,Ipot:145.2,name:"Aluminium Oxide",c:{O:.470749,Al:.529251}},235:{key:"Amber",density:1.1,Ipot:63.2,c:{H:.10593,C:.788974,O:.105096}},236:{key:"NH3",density:8.26E-4,Ipot:53.7,name:"Ammonia",c:{H:.177553,N:.822447}},237:{key:"C6H7N",density:1.0235,Ipot:66.2,name:"Aniline",
c:{H:.075763,C:.773831,N:.150405}},238:{key:"C14H10",density:1.283,Ipot:69.5,name:"Anthracene",c:{H:.056553,C:.943447}},239:{key:"A_150",density:1.127,Ipot:65.1,name:"A-150 plastic",c:{H:.101327,C:.7755,N:.035057,O:.0523159,F:.017422,Ca:.018378}},240:{key:"B_100",density:1.45,Ipot:85.9,name:"B-100 plastic",c:{H:.0654709,C:.536944,N:.0215,O:.032085,F:.167411,Ca:.176589}},241:{key:"BaF2",density:4.89,Ipot:375.9,name:"Barium Fluoride",c:{F:.216724,Ba:.783276}},242:{key:"BaSO4",density:4.5,Ipot:285.7,
name:"Barium Sulfate",c:{O:.274209,S:.137388,Ba:.588402}},243:{key:"Benzene",density:.87865,Ipot:63.4,c:{H:.077423,C:.922577}},244:{key:"BeO",density:3.01,Ipot:93.2,name:"Beryllium Oxide",c:{Be:.36032,O:.63968}},245:{key:"BGO",density:7.13,Ipot:534.1,name:"Bismuth Germanium Oxide",c:{O:.154108,Ge:.174919,Bi:.670973}},246:{key:"Blood_ICRP",density:1.06,Ipot:75.2,name:"Blood ICRP",c:{H:.101866,C:.10002,N:.02964,O:.759414,Na:.00185,Mg:4E-5,Si:3E-5,P:3.5E-4,S:.00185,Cl:.00278,K:.00163,Ca:6E-5,Fe:4.6E-4,
Zn:1E-5}},247:{key:"Bone_Compact",density:1.85,Ipot:91.9,name:"Bone Compact ICRP",c:{H:.063984,C:.278,N:.027,O:.410016,Mg:.002,P:.07,S:.002,Ca:.147}},248:{key:"Bone_Cortical",density:1.85,Ipot:106.4,name:"Bone Cortical ICRP",c:{H:.047234,C:.14433,N:.04199,O:.446096,Mg:.0022,P:.10497,S:.00315,Ca:.20993,Zn:1E-4}},249:{key:"Brain_ICRP",density:1.03,Ipot:73.3,c:{H:.110667,C:.12542,N:.01328,O:.737723,Na:.00184,Mg:1.5E-4,P:.00354,S:.00177,Cl:.00236,K:.0031,Ca:9E-5,Fe:5E-5,Zn:1E-5}},250:{key:"B4C",density:2.52,
Ipot:84.7,name:"Boron Carbide",c:{B:.78263,C:.21737}},251:{key:"BC_400",density:1.032,Ipot:64.7,name:"BC-400",c:{H:.085292,C:.914708}},252:{key:"C4H10O",density:.81,Ipot:59.9,name:"n-Butanol",c:{H:.135985,C:.648162,O:.215853}},253:{key:"C_552",density:1.76,Ipot:86.8,name:"C-552 plastic",c:{H:.02468,C:.50161,O:.004527,F:.465209,Si:.003973}},254:{key:"CdTe",density:6.2,Ipot:539.3,name:"Cadmium Telluride",c:{Cd:.468358,Te:.531642}},255:{key:"CdWO4",density:7.9,Ipot:468.3,name:"Cadmium Tungstate",c:{O:.177648,
Cd:.312037,W:.510314}},256:{key:"CaCO3",density:2.8,Ipot:136.4,name:"Calcium Carbonate",c:{C:.120003,O:.479565,Ca:.400432}},257:{key:"CaF2",density:3.18,Ipot:166,name:"Calcium Fluoride",c:{F:.486672,Ca:.513328}},258:{key:"CaO",density:3.34,Ipot:176.1,name:"Calcium Oxide",c:{O:.285309,Ca:.714691}},259:{key:"CaWO4",density:6.062,name:"Calcium Tungstate",c:{O:.222279,Ca:.139201,W:.63852}},260:{key:"CsF",density:4.115,name:"Caesium Fluoride",c:{F:.125069,Cs:.874931}},261:{key:"CsI",density:4.51,name:"Caesium Iodide",
c:{I:.488451,Cs:.511549}},262:{key:"CCl4",density:1.594,name:"Carbon Tetrachloride",c:{C:.078081,Cl:.921919}},263:{key:"C2Cl4",density:1.622,name:"Tetrachloroethylene",c:{C:.144853,Cl:.855147}},264:{key:"Cellophane",density:1.42,c:{H:.062162,C:.444462,O:.493376}},265:{key:"C6H5Cl",density:1.1058,name:"Chlorobenzene",c:{H:.044775,C:.640247,Cl:.314978}},266:{key:"CHCl3",density:1.4832,name:"Chloroform",c:{H:.008443,C:.100611,Cl:.890946}},267:{key:"C6H12",density:.779,name:"Cyclohexane",c:{H:.143719,
C:.856281}},268:{key:"Concrete",density:2.3,c:{H:.01,C:.001,O:.529107,Na:.016,Mg:.002,Al:.033872,Si:.337021,K:.013,Ca:.044,Fe:.014}},269:{key:"Diethyl Ether",density:.71378,name:"Diethyl Ether",c:{H:.135985,C:.648162,O:.215853}},270:{key:"C2H6",density:.00125324,name:"Ethane",c:{H:.201125,C:.798875}},271:{key:"C2H6O",density:.7893,name:"Ethanol",c:{H:.131275,C:.521429,O:.347296}},272:{key:"C2H4",density:.00117497,name:"Ethylene",c:{H:.143719,C:.856281}},273:{key:"Eye_lens",density:1.1,name:"Eye Lens ICRP",
c:{H:.099269,C:.19371,N:.05327,O:.653751}},274:{key:"Fe2O3",density:5.242,c:{O:.300574,Fe:.699426}},275:{key:"FeO",density:5.745,c:{O:.222695,Fe:.777305}},276:{key:"Freon_12",density:1.486,name:"Freon-12",c:{C:.099333,F:.314248,Cl:.586419}},277:{key:"Freon_12B2",density:2.27,name:"Freon-12B2",c:{C:.057244,F:.181096,Br:.76166}},278:{key:"Freon_13",density:1.526,name:"Freon-13",c:{C:.11498,F:.545623,Cl:.339397}},279:{key:"Freon_13B1",density:1.538,name:"Freon-13B1",c:{C:.080657,F:.38275,Br:.536593}},
280:{key:"Freon_13I1",density:1.538,name:"Freon-13I1",c:{C:.061307,F:.290925,I:.647768}},281:{key:"Gd2O2S",density:7.44,name:"Gadolinium Oxysulfide",c:{O:.084527,S:.084702,Gd:.830771}},282:{key:"GaAs",density:5.3176,name:"Gallium Arsenide",c:{Ga:.48203,As:.51797}},283:{key:"Gel_Photo_Emulsion",density:1.2914,name:"Gel in photographic emulsion",c:{H:.08118,C:.41606,N:.11124,O:.38064,S:.01088}},284:{key:"Glass_Pyrex",density:2.23,name:"Borosilicate glass",c:{B:.0400639,O:.539561,Na:.0281909,Al:.011644,
Si:.377219,K:.00332099}},285:{key:"Glass_Lead",density:6.22,name:"Glass Lead",c:{O:.156453,Si:.080866,Ti:.008092,As:.002651,Pb:.751938}},286:{key:"C6H12O6",density:1.54,name:"Glucose",c:{H:.067138,C:.40001,O:.532852}},287:{key:"C5H10N2O3",density:1.46,name:"Glutamine",c:{H:.068969,C:.410919,N:.191683,O:.32843}},288:{key:"C3H8O3",density:1.2613,name:"Glycerol",c:{H:.087558,C:.391254,O:.521188}},289:{key:"C5H5N5O",density:1.58,name:"Guanine",c:{H:.033348,C:.397373,N:.463411,O:.105868}},290:{key:"Gypsum",
density:2.32,c:{H:.023416,O:.557572,S:.186215,Ca:.232797}},291:{key:"C7H16",density:.68376,name:"n-Heptane",c:{H:.160945,C:.839055}},292:{key:"C6H14",density:.66603,name:"n-Hexane",c:{H:.163749,C:.836251}},293:{key:"KI",density:3.13,name:"Potassium Iodide",c:{K:.235528,I:.764472}},294:{key:"K2O",density:2.32,name:"Potassium Oxide",c:{O:.169852,K:.830148}},295:{key:"LaBr3",density:5.06,name:"Lanthanum Bromide",c:{La:.366876,Br:.633124}},296:{key:"LaOBr",density:6.28,name:"Lanthanum Oxybromide",c:{O:.068138,
Br:.340294,La:.591568}},297:{key:"La2O2S",density:5.86,name:"Lanthanum Oxysulfide",c:{O:.093598,S:.093792,La:.81261}},298:{key:"Lung",density:1.05,name:"Lung ICRP",c:{H:.101278,C:.10231,N:.02865,O:.757072,Na:.00184,Mg:7.3E-4,P:8E-4,S:.00225,Cl:.00266,K:.00194,Ca:9E-5,Fe:3.7E-4,Zn:1E-5}},299:{key:"MgCO3",density:2.958,name:"Magnesium Carbonate",c:{Mg:.288268,C:.142452,O:.56928}},300:{key:"MgF2",density:3.148,name:"Magnesium Fluoride",c:{Mg:.390117,F:.609883}},301:{key:"MgO",density:3.6,name:"Magnesium Oxide",
c:{Mg:.603036,O:.396964}},302:{key:"MS20_Tissue",density:1,name:"MS20 Tissue",c:{H:.081192,C:.583442,N:.017798,O:.186381,Mg:.130287,Cl:9E-4}},303:{key:"Muscle_skeletal",density:1.04,name:"Muscle Skeletal ICRP",c:{H:.100637,C:.10783,N:.02768,O:.754773,Na:7.5E-4,Mg:1.9E-4,P:.0018,S:.00241,Cl:7.9E-4,K:.00302,Ca:3E-5,Fe:4E-5,Zn:5E-5}},304:{key:"Muscle_strained",density:1.04,name:"Muscle Strained ICRP",c:{H:.101997,C:.123,N:.035,O:.729003,Na:8E-4,Mg:2E-4,P:.002,S:.005,K:.003}},305:{key:"Muscle_sucrose",
density:1.11,name:"Muscle with scrose",c:{H:.0982341,C:.156214,N:.035451,O:.710101}},306:{key:"Muscle_no_sucrose",density:1.07,name:"Muscle without scrose",c:{H:.101969,C:.120058,N:.035451,O:.742522}},307:{key:"Na2CO3",density:2.532,name:"Sodium carbonate",c:{C:.14471,O:.578301,Na:.27699}},308:{key:"NaI",density:3.667,name:"Sodium Iodide",c:{Na:.153373,I:.846627}},309:{key:"NaCl",density:2.165,name:"Sodium Chloride",c:{Na:.393372,Cl:.606628}},310:{key:"Na2O",density:2.27,name:"Sodium Oxide",c:{O:.258143,
Na:.741857}},311:{key:"NaNO3",density:2.261,name:"Sodium Nitrate",c:{N:.164795,O:.56472,Na:.270485}},312:{key:"C10H8",density:1.145,name:"Naphthalene",c:{H:.062912,C:.937088}},313:{key:"C6H5NO2",density:1.199,name:"Nitrobenzene",c:{H:.040937,C:.585367,N:.113774,O:.259922}},314:{key:"N2O",density:.00183,name:"Nitrous Oxide",c:{N:.636483,O:.363517}},315:{key:"C8H18",density:.703,name:"Octane",c:{H:.15883,C:.84117}},316:{key:"Paraffin",density:.93,c:{H:.148605,C:.851395}},317:{key:"C5H12",density:.626,
name:"n-Pentane",c:{H:.167644,C:.832356}},318:{key:"PhotoEmulsion",density:3.815,name:"Photo Emulsion",c:{H:.0141,C:.072261,N:.01932,O:.066101,S:.00189,Br:.349103,Ag:.474105}},319:{key:"PuO2",density:11.46,name:"Plutonium Dioxide",c:{O:.115911,Pu:.884089}},320:{key:"Polyacrylonitrile",density:1.184,c:{H:.056986,C:.679049,N:.263965}},321:{key:"Polycarbonate",density:1.2,c:{H:.055491,C:.755751,O:.188758}},322:{key:"PMMA",density:1.18,name:"PMMA - Plexiglass",c:{H:.080542,C:.59984,O:.319618}},323:{key:"POM",
density:1.42,name:"POM-Polyoxymethylene",c:{H:.067138,C:.40001,O:.532852}},324:{key:"C3H6",density:.9,name:"Polypropylene",c:{C:.856281,H:.143719}},325:{key:"C8H8",density:1.06,name:"Polystyrene",c:{C:.922577,H:.077423}},326:{key:"C3H8",density:.00188,name:"Propane",c:{H:.182864,C:.817136}},327:{key:"nPropanol",density:.8035,name:"n-Propanol",c:{H:.13418,C:.599585,O:.266235}},328:{key:"PVC",density:1.3,c:{H:.048382,C:.384353,Cl:.567264}},329:{key:"Pyridine",density:.9819,c:{H:.063713,C:.759211,N:.177076}},
330:{key:"SiO2",density:2.32,name:"Silicon dioxide",c:{O:.532565,Si:.467435}},331:{key:"Skin",density:1.1,name:"Skin ICRP",c:{H:.100588,C:.22825,N:.04642,O:.619002,Na:7E-5,Mg:6E-5,P:3.3E-4,S:.00159,Cl:.00267,K:8.5E-4,Ca:1.5E-4,Fe:1E-5,Zn:1E-5}},332:{key:"C12H22O11",density:1.587,name:"Sucrose",c:{H:.064782,C:.421063,O:.514155}},333:{key:"C2F4",density:2.2,name:"Teflon",c:{C:.240178,F:.759822}},334:{key:"TlCl",density:7.004,name:"Thallium Chloride",c:{Cl:.147822,Tl:.852178}},335:{key:"C7H8",density:.8669,
name:"Toluene",c:{H:.087515,C:.912485}},336:{key:"C2HCl3",density:1.46,name:"Trichloroethylene",c:{H:.007671,C:.182827,Cl:.809501}},337:{key:"WF6",density:2.4,name:"Tungsten Hexafluoride",c:{F:.382736,W:.617264}},338:{key:"UC2",density:11.28,name:"Uranium Dicarbide",c:{C:.091667,U:.908333}},339:{key:"UC",density:13.63,name:"Uranium Monocarbide",c:{C:.048035,U:.951965}},340:{key:"UO2",density:10.97,name:"Uranium Dioxide",c:{O:.118502,U:.881498}},341:{key:"Urea",density:1.323,c:{H:.067131,C:.2,N:.466459,
O:.266411}},342:{key:"C5H11NO2",density:1.23,name:"Valine",c:{H:.094645,C:.512637,N:.119566,O:.273152}},343:{key:"C10H7I",density:1.738,name:"Iodonaphthalene",c:{C:.472737,H:.027771,I:.499492}}};return{map:a,Get:function(b){return 200>b||343<b?{}:a[b.toString()]},GetName:function(b){b=a[b];return b.hasOwnProperty("key")?b.hasOwnProperty("name")?-1==b.key.indexOf("_")?b.name+" - "+b.key:b.name:b.key:""},GetZ:function(b){for(var c in a)if(a[c].hasOwnProperty("name")&&a[c].name.toLowerCase()==b.toLowerCase()||
a[c].key.toLowerCase()==b.toLowerCase())return parseInt(c);return 0}}}(),styles=styles||{};styles.container="mw-100 mw9-ns center ph2-ns";styles.container_narrow="mw-100 mw8-ns center ph4-ns";styles.my="my";styles.table="my mw-8 centered";styles.thead_tr="my";styles.tr="my";styles.th="my";styles.td="my";styles.div_column="flex flex-column items-center";styles.div_row="flex flex-wrap";styles.div_cell="pa2";styles.div_cell_auto="pa2 w-auto";styles.div_cell_full="w-100 pa2";styles.div_cell_100="w-100 pa2";
styles.div_cell_20="w-100 w-20-l pa2-ns";styles.div_cell_20a="w-auto w-20-l pa2-ns";styles.div_cell_80="w-100 w-80-l pa2-ns";styles.button_full="dib tc f5 w-100 ph3 pv2 link dim white bg-hcolor br3 mb2 pointer";styles.button="dib tc f6 fl ph3 pv2 link dim white bg-hcolor br2 mb2 pointer";styles.button_ns="dn dib-ns tc f6 fl ph3 pv2 link dim white bg-hcolor br2 mb2 pointer";styles.button_inverted="dib f6 fl ph3 pv2 link dim white hcolor br2 mb2 pointer ba b--hcolor";styles.button_pill="dib f6 ph3 pv2 link dim white bg-hcolor br-pill mb2 pointer";
styles.button_svg="f6 fl ph1 pv1 link dim pointer";styles.card="db center mv2 br3 shadow-4";styles.card_header="f5 bg-hcolor white pv2 ph3";styles.card_main="f6 pa2 ba b--hcolor br3 br--bottom";styles.box="db center br3 shadow-4";styles.heading="f2";styles.heading_medium="f3";styles.h3="f4 b sans-serif w-100 mv1 tc";styles.form_element="mt2 ml3 w-100 w-auto-ns";styles.label="db f6 pa1";styles.ul="list pl0";styles.li="ph2";styles.footer="fixed bg-near-black w-100 bottom-0";styles.header="fixed bg-black w-100 ph1 pv1 pv2-ns ph2-ns";
styles.nav="pa2 bg-black overflow-hidden  br3 br--bottom mb1";styles.nav_item="pointer dim f5 fw6 dib mh2 white link fl";styles.nav_item_right="pointer dim f5 fw6 dib mh2 white link fr";styles.color_error="text-error";styles.error_badge="bg-dark-red pa2 ma2 br2 dib";styles.padding_vertical="pv2";styles.combine=function(a){return a.join(" ")};var Catima={energy_min:.001,energy_max:1E5,epsilon:1E-9};Catima.url=location.protocol+"//isotopea.com/api/catima/";
Catima.check_material_duplicate=function(a,b){return a.some(function(a){return a[0]==b[0]&&a[1]==b[1]&&a[5]==b[5]})};Catima.prepare=function(a,b){var c={},d=App.projectile.state,e=MatterEditor.vm.layers;if(1>e.length||.001>d.T)return{};c.projectile=[d.mA,d.Q,d.T];c.matter=[];for(d=0;d<e.length;d++){var f=e[d].toArray(),g=!1;a&&(g=Catima.check_material_duplicate(c.matter,f));b?0<e[d].rho&&0<e[d].th&&(a&&g||c.matter.push(f)):a&&g||c.matter.push(f)}App.state.config&&(c.config=App.state.config);return c};
Catima.prepare_one=function(a){var b={},c=App.projectile.state,d=MatterEditor.vm.layers;if(1>d.length||.001>c.T)return{};b.projectile=[c.mA,c.Q,c.T];b.matter=[];if(a>=d.length)return{};c=d[a].toArray();0<d[a].rho&&b.matter.push(c);App.state.config&&(b.config=App.state.config);return b};
Catima.check_cache=function(a){for(var b=[],c=0;c<Catima.data.length;c++){var d=Catima.data[c];if(200<d.Zm&&d.Zm==a[1]){if(0<d.I&&a[6]!=d.I)continue;b.push(d);break}if(d.Zm==a[1]&&d.Am==a[0]&&Math.abs(d.M-a[5])<Catima.epsilon&&!(0<d.I&&a[6]!=d.I)){b.push(d);break}}return b};Catima.data=[];Catima.clear=function(){Catima.data=[]};Catima.check_input=function(a){return!(a.projectile&&Array.isArray(a.projectile)&&3==a.projectile.length&&a.matter&&Array.isArray(a.matter))||1>a.matter.length?!1:!0};
Catima.calculate=function(a){return Catima.check_input(a)?m.request({method:"POST",url:Catima.url+"calculate",data:a,background:!0}).then(function(a){return a},function(a){return{error:"Failed to retrieve data"}}):Promise.resolve({})};
Catima.get_data=function(a){if(!Catima.check_input(a))return Promise.resolve([]);if(1==a.matter.length){var b=Catima.check_cache(a.matter[0]);if(1==b.length)return Promise.resolve(b)}return m.request({method:"POST",url:Catima.url+"data",data:a,background:!1}).then(function(a){if(!a.data)return[];Catima.data=[];for(var b=0;b<a.data.length;b++){entry={};entry.energy=new Float32Array(a.energy);entry.projectile=a.projectile;entry.dEdx=new Float32Array(a.data[b].dEdx);entry.range=new Float32Array(a.data[b].range);
var c=parseInt(a.data[b].Zm),f=parseFloat(a.data[b].Am);entry.Am=f;entry.Zm=c;entry.M=a.data[b].M;entry.I=a.data[b].I?a.data[b].I:0;Catima.data.push(entry)}return Catima.data},function(a){return[]})};Catima.energy_out=function(a,b,c,d){var e=d.at(a),f=c.at(a);if(e<b)return 0;a-=b*f;if(.001>a)return 0;for(var g=0;100>g;g++){var l=e-d.at(a)-b;if(1E-4>Math.abs(l))return a;a-=-l*f;if(.001>a)return 0;f=c.at(a)}return-1};
Catima.Eout_vs_thickness=function(a,b){var c=new spline(a.energy,a.dEdx),d=new spline(a.energy,a.range),e=d.at(b),f=100;1E3<f&&(f=1E3);10>f&&(f=10);var g=b/f;.001>g&&(g=.001);var l=new Float32Array(f),h=new Float32Array(f),k=new Float32Array(f),q=new Float32Array(f),p=b;l[0]=0;h[0]=p;k[0]=0;q[0]=c.at(b);for(var n=1;n<f;n++){p-=g;h[n]=p;var r=e-d.at(p);l[n]=r;k[n]=(b-p)*a.projectile.A;q[n]=c.at(p)}return[l,h,k,q]};
Catima.get_energy_out=function(){var a=MatterEditor.vm.layers;return 1==a.length&&0==a[0].th?Promise.resolve([App.projectile.state.T]):Catima.get_data(Catima.prepare()).then(function(b){var c=[];b=App.projectile.state.T;for(var d=0;d<a.length;d++){var e=Catima.check_cache(a[d].toArray());if(1!=e.length)return console.log("cache not found?, length = "+e.length),[];b=Catima.Eout_vs_thickness(e[0],b);b=(new spline(b[0],b[1])).at(.001*a[d].th);c.push(b)}return c})};
var NucleusSelector={ui:{},nuc:{},oninit:function(){NucleusSelector.nuc=App.projectile;NucleusSelector.ui.uiupdate();App.clear_cache()}};
NucleusSelector.ui.uiupdate=function(){NucleusSelector.ui.Symbol=NucleusSelector.nuc.state.Symbol;NucleusSelector.ui.A=NucleusSelector.nuc.state.A;NucleusSelector.ui.Z=NucleusSelector.nuc.state.Z;NucleusSelector.ui.Q=NucleusSelector.nuc.state.Q;NucleusSelector.ui.T=NucleusSelector.nuc.state.T.toFixed(4);NucleusSelector.ui.Brho=NucleusSelector.nuc.state.Brho.toFixed(4);NucleusSelector.ui.Beta=NucleusSelector.nuc.state.Beta.toFixed(6);NucleusSelector.ui.Gamma=NucleusSelector.nuc.state.Gamma.toFixed(5);
NucleusSelector.ui.P=NucleusSelector.nuc.state.P.toFixed(3);NucleusSelector.ui.Nth=NucleusSelector.nuc.state.Nth.toFixed(4);isNaN(NucleusSelector.ui.Nth)&&(NucleusSelector.ui.Nth="");App.clear_cache()};NucleusSelector.ui.changesymbol=function(a){NucleusSelector.ui.Symbol=a;NucleusSelector.nuc.SetNucleusSymbol(a)&&NucleusSelector.ui.uiupdate()};
NucleusSelector.ui.changeA=function(a){NucleusSelector.ui.A=a;var b=parseFloat(a);!isNaN(b)&&NucleusSelector.nuc.Set.A(b)&&(NucleusSelector.ui.uiupdate(),NucleusSelector.ui.A=a)};NucleusSelector.ui.changeZ=function(a){NucleusSelector.ui.Z=a;var b=parseFloat(a);!isNaN(b)&&NucleusSelector.nuc.Set.Z(b)&&(NucleusSelector.ui.uiupdate(),NucleusSelector.ui.Z=a)};
NucleusSelector.ui.changeQ=function(a){NucleusSelector.ui.Q=a;var b=parseFloat(a);!isNaN(b)&&NucleusSelector.nuc.Set.Q(b)&&(NucleusSelector.ui.uiupdate(),NucleusSelector.ui.Q=a)};NucleusSelector.ui.changeT=function(a){NucleusSelector.ui.T=a;var b=parseFloat(a);!isNaN(b)&&NucleusSelector.nuc.Set.T(b)&&(NucleusSelector.ui.uiupdate(),NucleusSelector.ui.T=a)};
NucleusSelector.ui.changeBeta=function(a){NucleusSelector.ui.Beta=a;var b=parseFloat(a);!isNaN(b)&&NucleusSelector.nuc.Set.Beta(b)&&(NucleusSelector.ui.uiupdate(),NucleusSelector.ui.Beta=a)};NucleusSelector.ui.changeGamma=function(a){NucleusSelector.ui.Gamma=a;var b=parseFloat(a);!isNaN(b)&&NucleusSelector.nuc.Set.Gamma(b)&&(NucleusSelector.ui.uiupdate(),NucleusSelector.ui.Gamma=a)};
NucleusSelector.ui.changeBrho=function(a){NucleusSelector.ui.Brho=a;var b=parseFloat(a);!isNaN(b)&&NucleusSelector.nuc.Set.Brho(b)&&(NucleusSelector.ui.uiupdate(),NucleusSelector.ui.Brho=a)};NucleusSelector.ui.changeP=function(a){NucleusSelector.ui.P=a;var b=parseFloat(a);!isNaN(b)&&NucleusSelector.nuc.Set.P(b)&&(NucleusSelector.ui.uiupdate(),NucleusSelector.ui.P=a)};
NucleusSelector.ui.changeNth=function(a){NucleusSelector.ui.Nth=a;var b=parseFloat(a);!isNaN(b)&&NucleusSelector.nuc.Set.Nth(b)&&(NucleusSelector.ui.uiupdate(),NucleusSelector.ui.Nth=a)};NucleusSelector.ui.done=function(){NucleusSelector.nuc.state.T>Catima.energy_max&&(alert("Maximal allowed energy is "+Catima.energy_max+" MeV/u"),NucleusSelector.nuc.Set.T(Catima.energy_max));NucleusSelector.nuc.state.T<Catima.energy_min&&alert("Set Energy more than "+Catima.energy_min+" MeV/u");App.Save();m.route.set("/")};
function form_element(a){return m("div",{class:styles.form_element},[m("label",{class:styles.label,for:a.id},a.label),m("input",{class:"db",id:a.id||"_id"+a.label,value:a.value,type:a.type||"text",placeholder:a.placeholder||"",style:a.style||"",oninput:a.oninput})])}
NucleusSelector.view=function(a){var b=function(a){return m("div",{class:styles.div_cell},a)};a=a.state.ui;var c=NucData.GetNucData(NucleusSelector.nuc.state.A,NucleusSelector.nuc.state.Z),d=NucData.GetNucS(NucleusSelector.nuc.state.A,NucleusSelector.nuc.state.Z);return m("div",[m("h2","Projectile"),m("div",{class:styles.div_row},[b(form_element({label:"Symbol",placeholder:"ie 12C",style:"width:7em",value:a.Symbol,oninput:m.withAttr("value",a.changesymbol,a)})),b(form_element({label:"A",style:"width:7em",
value:a.A,oninput:m.withAttr("value",a.changeA,a)})),b(form_element({label:"Z",style:"width:7em",value:a.Z,oninput:m.withAttr("value",a.changeZ,a)})),b(form_element({label:"Q",style:"width:7em",value:a.Q,oninput:m.withAttr("value",a.changeQ,a)}))]),m("div",{class:styles.div_row},[b(form_element({label:"Energy [MeV/u]",style:"width:7em",value:a.T,oninput:m.withAttr("value",a.changeT,a)})),b(form_element({label:"Brho [Tm]",style:"width:7em",value:a.Brho,oninput:m.withAttr("value",a.changeBrho,a)})),
b(form_element({label:m.trust("&#946;"),style:"width:7em",value:a.Beta,oninput:m.withAttr("value",a.changeBeta,a)})),b(form_element({label:m.trust("&#947;"),style:"width:7em",value:a.Gamma,oninput:m.withAttr("value",a.changeGamma,a)}))]),m("div",{class:styles.div_row},[b(form_element({label:m.trust("p [MeV/c]"),style:"width:7em",value:a.P,oninput:m.withAttr("value",a.changeP,a)})),b(form_element({label:m.trust("n<sub>th</sub>"),style:"width:7em",value:a.Nth,oninput:m.withAttr("value",a.changeNth,
a)}))]),m("div",{class:styles.div_row},[m("ul",{class:styles.ul},[m("li",{class:styles.li},"mA = ",NucleusSelector.nuc.state.mA.toFixed(5)+" u"),m("li",{class:styles.li},"A/Q = ",NucleusSelector.nuc.state.AoQ.toFixed(5)),c.hasOwnProperty("T")?m("li",{class:styles.li},"half life = ",c.T):null,d.hasOwnProperty("Sn")?m("li",{class:styles.li},"Sn = ",d.Sn.toFixed(3)+" MeV"):null,d.hasOwnProperty("Sp")?m("li",{class:styles.li},"Sp = ",d.Sp.toFixed(3)+" MeV"):null,d.hasOwnProperty("S2n")?m("li",{class:styles.li},
"S2n = ",d.S2n.toFixed(3)+" MeV"):null,d.hasOwnProperty("S2p")?m("li",{class:styles.li},"S2p = ",d.S2p.toFixed(3)+" MeV"):null,c.hasOwnProperty("M")?null:m("li",{class:styles.li},"warning: Nucleus was not found in the AME16 database")])]),m("div",{class:styles.div_row},m("div",{class:styles.div_cell},button("Done",a.done)))])};
var NucleusInfo={view:function(a){a=a.attrs.nucleus.state;return m("div",{class:styles.div_column},[m("span",{class:styles.h3},m.trust(a.Symbol+"<sup>"+a.Q+"+</sup>")),m("p",["T = ",.001>a.T?text_error(a.T.toPrecision(6)):a.T.toPrecision(6)," MeV/u",m("br"),m.trust("B&#961= "),a.Brho.toPrecision(6)," Tm",m("br"),"mA = ",a.mA.toFixed(5)," u",m("br"),"A/Q = ",a.AoQ.toFixed(4),m("br")]),button_route("Change","/nucchange")])}},StorageAPI=function(){function a(){try{var a=window.localStorage;a.setItem("__storage_test__",
"__storage_test__");a.removeItem("__storage_test__");return!0}catch(c){return!1}}return{available:a(),save:function(b,c){return a&&void 0!=c?(localStorage.setItem(b,JSON.stringify(c)),!0):!1},load:function(b){return a?JSON.parse(localStorage.getItem(b)):null}}}();function GetDensity(a){return 0<a&&99>a?ElementDensity.GetDensity(a):200<a&&(a=MOCADI_Matter.Get(a),a.density)?a.density:0}
function CompundMatterSelect(a){var b=[],c;for(c in MOCADI_Matter.map){var d=MOCADI_Matter.GetName(c);b.push([c,d])}b.sort(function(a,b){return a[1].localeCompare(b[1])});return m("select",{id:"id_compound_select",class:"db w-100",onchange:m.withAttr("value",a.onchange)},m("option",{value:""},"Add Compound"),b.map(function(a){return m("option",{value:a[0]},a[1])}))}
var render_composition=function(a){var b=[];if(a.hasOwnProperty("c"))for(var c in a.c)a.c.hasOwnProperty(c)&&b.push([c,a.c[c]]);if(b.length)return m("table",{class:styles.table},[m("thead",{},m("tr",{class:styles.thead_tr},[m("th",{class:styles.th},"Element"),m("th",{class:styles.th},"Weight Fraction")])),m("tbody",{},[b.map(function(a,b){return m("tr",{class:styles.tr},[m("td",{class:styles.td},a[0]),m("td",{class:styles.td},a[1])])})])])},MatterLayer=function(a){this.name=a.name||"";this.symbol=
a.symbol||"";this.A=a.A||"";this.mass=a.mass||"";this.Z=a.Z||"";this.rho=a.rho||0;this.th=a.th||0;this.gas=a.gas||!1;this.l=0;this.I=a.I||0;if(a.l)this.l=a.l;else{var b=parseFloat(a.rho);!isNaN(b)&&0<b&&(this.l=(parseFloat(a.th)/b/1E3).toFixed(4))}a.mass||(this.mass=""===this.A?ElementMass.GetMass(this.Z).toPrecision(5)||"":NucData.GetNucData(parseInt(a.A),parseInt(a.Z)).M||"")};
MatterLayer.prototype.toArray=function(){var a=parseInt(this.Z);if(isNaN(a))return[];var b=parseFloat(this.rho);if(isNaN(b))return[];var c=parseFloat(this.th);if(isNaN(c))return[];if(""===this.mass||null===this.mass)var d=0;else if(d=parseFloat(this.mass),isNaN(d)||0>d)return[];if(""===this.A||null===this.A)var e=0;else if(e=parseFloat(this.A),isNaN(e)||0>e)e=0;var f=0;if(""!==this.I&&null!==this.I){var g=parseFloat(this.I);!isNaN(g)&&0<g&&(f=g)}return[e,a,b,c,this.gas?1:0,d,f]};
var MatterEditor={vm:{layers:[],editindex:-1,thickness:0,length:0,calculate:function(){for(var a=this.length=this.thickness=0;a<this.layers.length;a++){var b=this.layers[a];this.thickness+=parseFloat(b.th);this.length+=parseFloat(b.l)}}},ui:{}};
MatterEditor.ui.changeSymbol=function(a,b){var c=MatterEditor.vm.layers[a],d=NucID.GetNuc(b);1>d[1]&&(c.Z="",c.A="",c.mass="",d[1]=MOCADI_Matter.GetZ(b));0<d[0]&&(c.mass=NucData.GetNucData(d[0],d[1]).M.toPrecision(7),c.A=d[0].toString());0===d[0]&&0<d[1]&&(c.A="",c.mass=ElementMass.GetMass(d[1]).toPrecision(7));0<d[1]&&(c.Z=d[1].toString(),d=GetDensity(d[1]),c.rho=d,c.gas=.01>d&&0<d?1:0);c.symbol=b;this.changel(a,c.l)};
MatterEditor.ui.changeZ=function(a,b){var c=MatterEditor.vm.layers[a],d=parseInt(b);c.Z=b;c.I="";if(isNaN(d)||1>d)c.A="",c.mass="",c.symbol="";else{b=parseInt(c.A);if(isNaN(b)||1>b)b=0;if(120>d){var e=NucID.GetSymbol(b,d);MatterEditor.vm.layers[a].mass=0<b?NucData.GetNucData(b,d).M.toPrecision(7):ElementMass.GetMass(d).toPrecision(7)}200<d&&(e=MOCADI_Matter.Get(d),e=e.key?e.key:"",MatterEditor.vm.layers[a].mass="",MatterEditor.vm.layers[a].A="");d=GetDensity(d);c.symbol=e;c.rho=d;c.gas=.01>d&&0<d?
1:0;this.changel(a,c.l)}};MatterEditor.ui.changeA=function(a,b){var c=MatterEditor.vm.layers[a],d=parseInt(b);b=parseInt(c.Z);if(isNaN(d)||0>d)a=NucID.GetSymbol(0,b),c.symbol=a,c.A="",c.mass=ElementMass.GetMass(b).toPrecision(7);else{c.A=d;var e=NucID.GetSymbol(d,b);c.symbol=e;b=NucData.GetNucData(d,b);c.mass=b.M?b.M.toPrecision(7):"";this.changel(a,c.l)}m.redraw()};
MatterEditor.ui.changerho=function(a,b){a=MatterEditor.vm.layers[a];var c=parseFloat(b),d=parseFloat(a.l);a.rho=b;isNaN(c)||0>c||(a.th=(d*c*1E3).toPrecision(3),m.redraw())};MatterEditor.ui.changel=function(a,b){a=MatterEditor.vm.layers[a];var c=parseFloat(b),d=parseFloat(a.rho);parseFloat(a.th);a.l=b;isNaN(c)||0>c||isNaN(d)||0>d||(a.th=(c*d*1E3).toPrecision(4),m.redraw())};
MatterEditor.ui.changeth=function(a,b){a=MatterEditor.vm.layers[a];var c=parseFloat(b),d=parseFloat(a.rho);parseFloat(a.l);a.th=b;isNaN(c)||0>c||isNaN(d)||0>d||(a.l=(c/d/1E3).toPrecision(4),m.redraw())};MatterEditor.ui.Remove=function(a){-1==MatterEditor.vm.editindex&&(MatterEditor.vm.layers.splice(a,1),App.clear_cache(),App.Save(),MatterEditor.vm.calculate(),m.redraw())};
MatterEditor.ui.Add=function(){MatterEditor.vm.editindex=MatterEditor.vm.layers.length;MatterEditor.vm.layers.push(new MatterLayer({symbol:"",name:"",A:"",Z:"",mass:"",rho:0,th:0,gas:!1}))};MatterEditor.ui.Down=function(a){if(!(a>=MatterEditor.vm.layers.length-1)&&-1==MatterEditor.vm.editindex){var b=MatterEditor.vm.layers[a];MatterEditor.vm.layers[a]=MatterEditor.vm.layers[a+1];MatterEditor.vm.layers[a+1]=b;App.clear_cache();App.Save();m.redraw()}};
MatterEditor.ui.Up=function(a){if(!(1>a)&&-1==MatterEditor.vm.editindex){var b=MatterEditor.vm.layers[a];MatterEditor.vm.layers[a]=MatterEditor.vm.layers[a-1];MatterEditor.vm.layers[a-1]=b;App.clear_cache();App.Save();m.redraw()}};
MatterEditor.ui.EditDone=function(){var a=MatterEditor.vm.layers[MatterEditor.vm.editindex];""===a.Z&&(alert("Wrong matter defined, matter removed"),MatterEditor.vm.editindex=-1,MatterEditor.ui.Remove(MatterEditor.vm.editindex));""===a.name&&(a.name="Material_"+MatterEditor.vm.editindex);isNaN(parseFloat(a.l))&&(a.l=0,a.th=0);isNaN(parseFloat(a.th))&&(a.l=0,a.th=0);isNaN(parseFloat(a.rho))&&(a.rho=GetDensity(a.Z));a.l=parseFloat(a.l);a.th=parseFloat(a.th);a.rho=parseFloat(a.rho);MatterEditor.vm.editindex=
-1;App.clear_cache();App.Save();MatterEditor.vm.calculate()};MatterEditor.ui.Edit=function(a){-1==MatterEditor.vm.editindex&&(MatterEditor.vm.editindex=a,m.redraw())};
MatterEditor.view=function(a){var b=a.state.vm,c=a.state.ui;return-1<b.editindex?MaterialEditor_itemEdit(b.layers[b.editindex],b.editindex,c):m("div",{style:"overflow-x:auto;"},[m("table",{class:styles.table},[m("thead",{class:""},[m("tr",[m("th",{class:styles.th},"#"),m("th",{class:styles.th},"name"),m("th",{class:styles.th},"matter"),m("th",{class:styles.th},m.trust("density<br>(g/cm<sup>3</sub>)")),m("th",{class:styles.th},m.trust("thick.<br>(mg/cm<sup>2</sup>)")),m("th",{class:styles.th},m.trust("thick.<br>(cm)")),
m("th",{class:styles.th},"")])]),m("tbody",b.layers.map(function(a,b){return m("tr",{class:styles.tr,ondblclick:c.Edit.bind(c,b)},[m("td",{class:styles.td},b),m("td",{class:styles.td},a.name),m("td",{class:styles.td},a.symbol),m("td",{class:styles.td},a.rho),m("td",{class:styles.td},0<a.th?a.th:text_error(a.th)),m("td",{class:styles.td},0<a.l?a.l:text_error(a.l)),m("td",{class:styles.td},m("span",{class:"flex flex-row dib bg-moon-gray br-pill ph2"},[m("a",{class:styles.button_svg,onclick:noredraw(c.Up.bind(c,
b)),title:"Move Up"},m.trust(svg_up(24))),m("a",{class:styles.button_svg,onclick:noredraw(c.Down.bind(c,b)),title:"Move Down"},m.trust(svg_down(24))),m("a",{class:styles.button_svg,onclick:noredraw(c.Edit.bind(c,b)),title:"Edit"},m.trust(svg_edit(24))),m("a",{class:styles.button_svg,onclick:noredraw(c.Remove.bind(c,b)),title:"Delete"},m.trust(svg_delete(24)))]))])}))]),m("div",{class:styles.combine([styles.div_row,styles.padding_vertical])},[m("div",{class:styles.div_cell_20},m("a",{class:styles.button_pill,
onclick:c.Add.bind(c)},"Add Matter")),m("div",{class:styles.div_cell_80},b.layers.length?m("div",["Total thickness = "+b.thickness.toFixed(3)+" mg/cm2",m("br"),"Total length = "+b.length.toFixed(3)+" cm"]):null)]),m("span",[FileLoader({class:styles.button,id:"loadmatter",title:"Add from File"},AddLayersFromFile),b.layers.length?[button("Save as MOCADI",function(){SaveFile(App.MOCADIstr(),"input.in")},styles.button_ns),button_route("Plots","/plot")]:null])])};
function MaterialEditor_itemEdit(a,b,c){return m("div",{onkeyup:escape(c.EditDone.bind(c))},[m("div",{class:styles.h3},"Material #"+b),m("div",{class:styles.div_row},[m("div",{class:styles.form_element},[m("label",{class:styles.label,for:"input_material_name",title:"Name of the matter, ie vacuum window, this is optional"},"Name"),m("input",{type:"text",style:"width:10em;",placeholder:"optional name",id:"input_material_name",oninput:function(b){b.redraw=!1;a.name=b.currentTarget.value},value:a.name})]),
m("div",{class:styles.form_element},[m("label",{class:styles.label,for:"input_material_symbol",title:"Type element or nucleus symbol or compund matter ie air, P10, water..."},"Symbol"),m("input",{type:"text",style:"width:10em",placeholder:"i.e. Fe, 12C",id:"input_material_symbol",oninput:m.withAttr("value",c.changeSymbol.bind(c,b)),value:a.symbol})]),m("div",{class:styles.form_element},[m("label",{class:styles.label,for:"input_material_A",title:"Mass number or leave empty or zero for natural target"},
"A"),m("input",{type:"text",style:"width:7em;",id:"input_material_A",oninput:withAttr_nr("value",c.changeA.bind(c,b)),value:a.A})]),m("div",{class:styles.form_element},[m("label",{class:styles.label,for:"input_material_Z"},"Z"),m("input",{type:"text",style:"width:7em;",id:"input_material_Z",oninput:m.withAttr("value",c.changeZ.bind(c,b)),value:200>a.Z?a.Z:""})])]),m("div",{class:styles.div_row},[m("div",{class:styles.form_element},[m("label",{class:styles.label,for:"input_material_mass"},m.trust("mass<br>(u)")),
m("input",{type:"text",style:"width:7em;",id:"input_material_mass",oninput:function(b){b.redraw=!1;a.mass=b.currentTarget.value},value:a.mass})]),m("div",{class:styles.form_element},[m("label",{class:styles.label,for:"input_material_rho"},m.trust("density<br>(g/cm<sup>3</sub>)")),m("input",{type:"text",style:"width:7em;",id:"input_material_rho",oninput:withAttr_nr("value",c.changerho.bind(c,b)),value:a.rho})]),m("div",{class:styles.form_element},[m("label",{class:styles.label,for:"input_material_th"},
m.trust("Thickness<br>(mg/cm<sup>2</sub>)")),m("input",{type:"text",style:"width:7em;",id:"input_material_th",oninput:withAttr_nr("value",c.changeth.bind(c,b)),value:a.th})]),m("div",{class:styles.form_element},[m("label",{class:styles.label,for:"input_material_l"},m.trust("Length<br>(cm)")),m("input",{type:"text",style:"width:7em;",id:"input_material_l",oninput:withAttr_nr("value",c.changel.bind(c,b)),value:a.l})]),m("div",{class:styles.form_element},[m("label",{class:styles.label},m.trust("Thickness<br>calculator")),
m(ThicknessCalculator,{index:b})])]),m("div",{class:styles.combine([styles.div_row,"items-center mt2"])},[m("div",{class:styles.div_cell_20},m("a",{class:styles.button_full,onclick:c.EditDone.bind(c)},"Done")),m("div",{class:styles.div_cell_80},["Compounds:",CompundMatterSelect({onchange:c.changeZ.bind(c,b)})])]),200<a.Z?m("div",{class:styles.combine([styles.div_row,"items-center justify-center"])},[m("div",{class:styles.div_cell},[m("div",{class:styles.h3},MOCADI_Matter.GetName(a.Z)),render_composition(MOCADI_Matter.Get(a.Z))]),
m("div",{class:styles.form_element},[m("label",{class:styles.label,for:"input_material_I",title:"Mean Ionization Potential in eV or empty for elemental ionization potentials"},"<I>",m("input",{class:"db",type:"text",style:"width:7em;",id:"input_material_I",onkeyup:enterescape(c.EditDone.bind(c),c.EditDone.bind(c)),oninput:function(b){b.redraw=!1;0==b.currentTarget.value.length?a.I=0:(b=parseFloat(b.currentTarget.value),!isNaN(b)&&0<b&&(a.I=b,m.redraw()))},value:0<a.I?a.I:""}))]),m("div",{class:styles.div_cell},
m("a",{href:"physics.html#compounds",target:"_blank",title:"Bragg Rules is used to calculate energy loss of compounds. For custom non-elemental Ionization potential enter the mean I value in eV units or leave empty, click for more details"},m.trust(svg_info())))]):null])}
var thickness_calculator2={th:0,l:0,calculate_th:function(a,b,c){var d=MatterEditor.vm.layers[a].rho;d=parseFloat(d);var e=parseFloat(c);isNaN(e)||0>e?console.log("could not parse number"):Catima.get_energy_out().then(function(b){return a>=b.length?-1:Ein=0<a?b[a-1]:App.projectile.state.T}).then(function(c){thickness_calculator2.th=-1;thickness_calculator2.l=-1;0>c||0==b&&e>c||1==b&&1<e||Catima.get_data(Catima.prepare_one(a)).then(function(a){a=new spline(a[0].energy,a[0].range);thickness_calculator2.th=
0==b?1E3*(a.at(c)-a.at(e)):1E3*a.at(c)*e;thickness_calculator2.l=thickness_calculator2.th/d/1E3;m.redraw()})})}},ThicknessCalculator={submit:function(a,b,c){0<b&&(MatterEditor.ui.changeth(a,b.toFixed(2)),c&&c.apply(this))},oninit:function(){thickness_calculator2.th=0;thickness_calculator2.l=0},view:function(a){var b=thickness_calculator2;var c=a.attrs.index;return m(ToggleComponent,{id:"_thcal",title:"Calculate",content:m("div",{class:styles.div_column},[button_route("Show Plots","/materialplot"),
m("div","Adjust thickness to: "),m("label",{class:styles.label,for:"input_Eout",title:"Enter Energy after material"},"Eout (MeV/u)"),m("input",{type:"text",style:"width:7em;",id:"input_Eout",oninput:withAttr_nr("value",debounce(b.calculate_th.bind(a.state,c,0),500))}),m("label",{class:styles.label,for:"input_RangeFraction",title:"Enter Fraction of Range"},"th/range"),m("input",{type:"text",style:"width:7em;",id:"input_RangeFraction",oninput:withAttr_nr("value",debounce(b.calculate_th.bind(a.state,
c,1),500))}),0<=b.th?m("div",{class:styles.div_cell},["Th. = "+b.th.toFixed(2),m.trust(" mg/cm<sup>2</sup><br>"),"Length    = "+b.l.toFixed(5)+" cm"]):m("div",text_error("Wrong value!")),0<b.th?button("Submit Thickness",a.state.submit.bind(a.state,c,b.th,ToggleComponent.off.bind(this,"_thcal"))):null])})}};
function ThicknessCalculator2(a){var b=thickness_calculator2,c=a.attrs.index,d=function(){0<b.th&&MatterEditor.ui.changeth(c,b.th.toFixed(2))};return{view:function(a){var c=a.attrs.index;return m("div",{class:styles.form_element},[m("div",{class:styles.div_cell},"Adjust thickness to: "),m("label",{class:styles.label,for:"input_Eout",title:"Enter Energy after material"},"Eout (MeV/u)"),m("input",{type:"text",style:"width:7em;",id:"input_Eout",oninput:withAttr_nr("value",debounce(b.calculate_th.bind(a.state,
c),500))}),0<=b.th?m("div",{class:styles.div_cell},["Thickness = "+b.th.toFixed(2),m.trust(" mg/cm<sup>2</sup><br>"),m("div",{class:styles.div_cell},"Length    = "+b.l.toFixed(5)+" cm")]):text_error("Wrong value"),button("Submit Thickness",d)])}}}
var catima_z_eff=[["none",0],["Pierce-Blann",1],["Anthony-Landorf",2],["Hubert",3],["Winger",4],["Schiwietz",5],["Global",6],["Atima v1.4",7]],catima_omega={"atima1.3":0,Bohr:1},config_atima13={z_effective:1,dedx_straggling:0},config_atima14={z_effective:7,dedx_straggling:0},config_presets=[{name:"atima v1.3",config:config_atima13},{name:"atima v1.4",config:config_atima14}];
function catima_config(a){this.z_effective=config_atima13.z_effective;this.dedx_straggling=config_atima13.dedx_straggling;a&&(a.z_effective&&(this.z_effective=a.z_effective),a.dedx_straggling&&(this.dedx_straggling=a.dedx_straggling))}catima_config.prototype.is_same=function(a){return this.z_effective==a.z_effective&&this.dedx_straggling==a.dedx_straggling?!0:!1};catima_config.prototype.set=function(a){this.z_effective=a.z_effective;this.dedx_straggling=a.dedx_straggling};
var ConfigComponent={view:function(a){return m("div",{class:styles.div_column},[m("div",{class:styles.form_element},[m("h1",{class:styles.heading_medium},"Presets:"),config_presets.map(function(a){return App.state.config.is_same(a.config)?button(a.name):m("a",{class:styles.button_inverted,onclick:function(){App.state.config.set(a.config);App.clear_cache();App.Save()}},a.name)})]),m("div",{class:styles.form_element},button_route("Done","/"))])}};
function VegaPlot(a){var b=a.attrs;return{oninit:function(){b.status="loading"},oncreate:function(){"undefined"===typeof vega?append_script(["https://cdn.jsdelivr.net/npm/vega@3.3.1","https://cdn.jsdelivr.net/npm/vega-lite@2.4.1","https://cdn.jsdelivr.net/npm/vega-embed@3.7.1"]).then(function(){b.Get()}):b.Get()},view:function(){return m("div",{id:"catima_plot"},b.status)}}}
var AtimaResults={result:{},matter_names:[],done:!0,prepare:function(){var a=MatterEditor.vm.layers;AtimaResults.matter=MatterEditor.vm.layers;for(var b=0;b<a.length;b++)AtimaResults.matter_names.push(a[b].name)},prepareoutput:function(a){a.result&&(a.result.sigma_a*=1E3);if(a.partial)for(var b in a.partial)a.partial[b].sigma_a*=1E3},getResult:function(){if(!(App.datavalid&&App.result&&AtimaResults.done)||App.result.error){AtimaResults.result={};AtimaResults.matter_names=[];AtimaResults.done=!1;AtimaResults.prepare();
var a=Catima.prepare();Catima.calculate(a).then(function(a){!a.result||a.error?(AtimaResults.done=!0,App.clear_cache(),AtimaResults.result={error:"Failed to retrieve data from Atima Server"}):(AtimaResults.done=!0,App.datavalid=!0,AtimaResults.prepareoutput(a),AtimaResults.result=a,a.result&&(AtimaResults.result.result.Brho=NucKinematics.brho_from_T(a.result.Eout,a.projectile.A,a.projectile.Z).toPrecision(6),AtimaResults.result.result.Beta=NucKinematics.beta_from_T(a.result.Eout).toPrecision(6)),
App.result=AtimaResults.result);m.redraw()},function(a){AtimaResults.done=!0;App.clear_cache();AtimaResults.result={error:"Failed to retrieve data from Atima Server"};m.redraw()})}}},AtimaResultsView={oninit:function(){AtimaResults.getResult()},TotalTemplate:function(){var a=function(a){return.01>a?a.toExponential(4):a.toFixed(4)},b=AtimaResults.result;return b.result?m("div",{class:styles.div_row},[m("div",{class:styles.div_cell_100},[m("p","Projectile: ",App.projectile.state.Symbol)]),m("div",{class:styles.div_cell_auto},
[m("p",m.trust("E<sub>in</sub>")," = ",a(b.result.Ein)," MeV/u"),m("p",m.trust("E<sub>out</sub>")," = ",b.result.Eout.toFixed(4)," MeV/u"),m("p",m.trust("E<sub>loss</sub>")," = ",a(b.result.Eloss)," MeV")]),m("div",{class:styles.div_cell_auto},[m("p",m.trust("B&#961")," = ",b.result.Brho," Tm"),m("p",m.trust("&#946")," = ",b.result.Beta),m("p",m.trust("TOF")," = ",b.result.tof.toFixed(6)," ns")]),m("div",{class:styles.div_cell_auto},[m("p",m.trust("&#963<sub>E</sub>")," = ",a(b.result.sigma_E)," MeV/u"),
0<b.result.Eout?m("p",m.trust("&#963<sub>p</sub>/p = "),relative_momentum_deviation(b.result.sigma_E,b.result.Eout).toExponential(3)):null,m("p",m.trust("&#963<sub>a</sub>")," = ",a(b.result.sigma_a)," mrad")])]):null},PartialTemplate:function(){var a=function(a){return.01>a?a.toExponential(3):a.toFixed(3)},b=AtimaResults.result;return b.partial?m("div",{style:"overflow-x:auto;"},[m("table",{class:styles.table},[m("thead",m("tr",{class:styles.thead_tr},[m("th",{class:styles.th},"#"),m("th",{class:styles.th},
"name"),m("th",{class:styles.th},m.trust("E<sub>in</sub><br>(MeV/u)")),m("th",{class:styles.th},m.trust("E<sub>out</sub><br>(MeV/u)")),m("th",{class:styles.th},m.trust("E<sub>loss</sub><br>(MeV)")),m("th",{class:styles.th},m.trust("&#963<sub>E</sub><br>(MeV/u)")),m("th",{class:styles.th},m.trust("&#963<sub>a</sub><br>(mrad)")),m("th",{class:styles.th},m.trust("range<br>(g/cm<sup>2</sup>)")),m("th",{class:styles.th},m.trust("&#963<sub>r</sub><br>(g/cm<sup>2</sup>)")),m("th",{class:styles.th},m.trust("dE<sub>in</sub>/dx<br>(MeV/(g/cm<sup>2</sup>))")),
m("th",{class:styles.th},m.trust("tof<br>(ns)")),m("th",{class:styles.th},m.trust("d/R")),m("th",{class:styles.th},m.trust("W<sub>e</sub>")),m("th",{class:styles.th},m.trust("W<sub>p</sub>"))])),m("tbody",b.partial.map(function(c,d){var e=NucKinematics.brho_from_T(c.Eout,b.projectile.A,b.projectile.Z).toPrecision(6)+"  Tm",f=NucKinematics.beta_from_T(c.Eout).toPrecision(6);e="Brho = "+e+"\nBeta = "+f;f="material: "+AtimaResults.matter[d].symbol+"\nl = "+AtimaResults.matter[d].l+" cm\nth. = "+AtimaResults.matter[d].th+
" g/cm2\ndensity = "+AtimaResults.matter[d].rho+" g/cm3";return m("tr",{class:styles.tr},[m("td",{class:styles.td},d),m("td",{class:styles.td,title:f},AtimaResults.matter[d].name),m("td",{class:styles.td},a(c.Ein)),m("td",{class:styles.td,title:e},a(c.Eout)),m("td",{class:styles.td},a(c.Eloss)),m("td",{class:styles.td},a(c.sigma_E)),m("td",{class:styles.td},a(c.sigma_a)),m("td",{class:styles.td},a(c.range)),m("td",{class:styles.td},a(c.sigma_r)),m("td",{class:styles.td},a(c.dEdxi)),m("td",{class:styles.td},
a(c.tof)),m("td",{class:styles.td},0<c.range?a(.001*AtimaResults.matter[d].th/c.range):""),m("td",{class:styles.td},c.we&&0<c.we?a(c.we):""),m("td",{class:styles.td},c.wp&&0<c.wp?a(c.wp):"")])}))])]):null},view:function(a){a=AtimaResults.result;return AtimaResults.done?a.error?badge_error("Error: "+a.error):a.result?m("div",[m("div",{class:styles.h3},"Results"),m("div",{class:styles.div_cell_full},m(CardComponent,{title:"Total Results",content:AtimaResultsView.TotalTemplate()})),m("div",{class:styles.div_cell_full},
m(CardComponent,{title:"Partial Results",content:AtimaResultsView.PartialTemplate()}))]):badge_error("Error: Could not find results"):m("span","Loading...")}},MaterialPlotComponent={},MaterialPlotData={values:[],status:"",sort:function(a){MaterialPlotData.values=[];if(1==a.length){a=a[0];for(var b=Catima.Eout_vs_thickness(a,App.projectile.state.T),c=0;c<b[0].length;c++){var d=201>a.Zm?NucID.GetSymbol(a.Am,a.Zm):MOCADI_Matter.Get(a.Zm).name;MaterialPlotData.values.push({th:b[0][c],Eout:b[1][c],Eloss:b[2][c],
dEdx:b[3][c],material:d})}}},Get:function(){MaterialPlotData.data=[];var a=App.get_editindex();0>a||Catima.get_data(Catima.prepare_one(a)).then(function(a){console.log(a);0<a.length?(MaterialPlotData.sort(a),MaterialPlotData.plot()):MaterialPlotData.status="failed"})},plot:function(){if(!(1>MaterialPlotData.values.length)){var a=get_div_size("catima_plot");a={$schema:"https://vega.github.io/schema/vega-lite/v2.json",title:"Energy after material , projectile: "+App.projectile.GetNucleusSymbol()+", T = "+
App.projectile.state.T+"MeV/u",width:a[0]-10,height:2*a[0]/3|0,autosize:{type:"fit"},data:{values:MaterialPlotData.values},layer:[{mark:"circle",encoding:{x:{field:"th",type:"quantitative",scale:{type:"linear"},axis:{title:"thickness (g/cm2)"}},y:{field:"Eout",type:"quantitative",scale:{type:"linear"},axis:{title:"Eout [MeV/u]"}},color:{field:"material",type:"nominal"}},selection:{grid:{type:"interval",bind:"scales"}}},{mark:"line",encoding:{x:{field:"th",type:"quantitative"},y:{field:"Eout",type:"quantitative"},
color:{field:"material",type:"nominal"}}}]};MaterialPlotData.fig=a;MaterialPlotData.update()}},update:function(){vegaEmbed("#catima_plot",MaterialPlotData.fig,{mode:"vega-lite",actions:!1})},plot_options:[{value:"Eout",name:"Energy after"},{value:"Eloss",name:"Energy loss"},{value:"dEdx",name:"dEdx"}],change_y_axis:function(a){"Eout"==a&&(MaterialPlotData.fig.data.values=MaterialPlotData.values,MaterialPlotData.fig.title="Energy after material, projectile: "+App.projectile.GetNucleusSymbol()+", T = "+
App.projectile.state.T+"MeV/u",MaterialPlotData.fig.layer[0].encoding.y.axis.title="Eout [MeV/u]",MaterialPlotData.fig.layer[0].encoding.y.scale.type="linear",MaterialPlotData.fig.layer[0].encoding.y.field=a,MaterialPlotData.fig.layer[1].encoding.y.field=a);"Eloss"==a&&(MaterialPlotData.fig.data.values=MaterialPlotData.values,MaterialPlotData.fig.title="Energy loss in material, projectile: "+App.projectile.GetNucleusSymbol()+", T = "+App.projectile.state.T+"MeV/u",MaterialPlotData.fig.layer[0].encoding.y.axis.title=
"Energy loss [MeV]",MaterialPlotData.fig.layer[0].encoding.y.scale.type="linear",MaterialPlotData.fig.layer[0].encoding.y.field=a,MaterialPlotData.fig.layer[1].encoding.y.field=a);"dEdx"==a&&(MaterialPlotData.fig.data.values=MaterialPlotData.values,MaterialPlotData.fig.title="Energy loss in material, projectile: "+App.projectile.GetNucleusSymbol()+", T = "+App.projectile.state.T+"MeV/u",MaterialPlotData.fig.layer[0].encoding.y.axis.title="dEdx [MeV/g/cm2]",MaterialPlotData.fig.layer[0].encoding.y.scale.type=
"log",MaterialPlotData.fig.layer[0].encoding.y.field=a,MaterialPlotData.fig.layer[1].encoding.y.field=a);MaterialPlotData.update()}};
MaterialPlotComponent.view=function(a){return m("div",{class:styles.div_row},[MaterialPlotData.plot_options?m("div",{class:styles.div_cell_20},[m("label",{class:styles.label},"Plot"),m("select",{onchange:m.withAttr("value",MaterialPlotData.change_y_axis)},MaterialPlotData.plot_options.map(function(a){return m("option",{value:a.value},a.name)})),m("div",{class:styles.div_cell},button_route("Done","/"))]):null,m("div",{class:styles.div_cell_80},m(VegaPlot,MaterialPlotData))])};
var PlotComponent={},PlotData={values:[],status:"",sort:function(a){PlotData.values=[];1>a.length||a.forEach(function(a){for(var b=1;b<a.energy.length;b++){var d=201>a.Zm?NucID.GetSymbol(a.Am,a.Zm):MOCADI_Matter.Get(a.Zm).name;PlotData.values.push({energy:a.energy[b],dEdx:a.dEdx[b],range:a.range[b],material:d})}})},derived:function(a){PlotData.derived_values=[];if(!(1>Catima.data.length)){a=MatterEditor.vm.layers;for(var b=0;b<a.length;b++)if(!(0>=a[b].rho||0>=a[b].th))for(var c=a[b].name,d=a[b].th,
e=0;e<Catima.data.length;e++){var f=Catima.data[e];if(f.Am==a[b].A&&f.Zm==a[b].Z&&!(200>f.Zm&&f.M!=a[b].mass))for(var g=1;g<f.energy.length;g++)PlotData.derived_values.push({energy:f.energy[g],y:.001*d/f.range[g],material:c})}}},Get:function(){PlotData.data=[];0==Catima.data.length?Catima.get_data(Catima.prepare(unique=!0)).then(function(a){0<a.length?(PlotData.sort(a),PlotData.plot()):PlotData.status="failed"}):(PlotData.sort(Catima.data),PlotData.plot())},plot:function(){if(1>PlotData.values.length)console.log("failed");
else{var a=get_div_size("catima_plot");a={$schema:"https://vega.github.io/schema/vega-lite/v2.json",title:"projectile: "+App.projectile.GetNucleusSymbol(),width:a[0]-90,height:2*a[0]/3|0,autosize:{type:"fit"},data:{values:PlotData.values},selection:{grid:{type:"interval",bind:"scales"}},mark:"circle",encoding:{x:{field:"energy",type:"quantitative",scale:{type:"log"},axis:{title:"Energy [MeV/u]"}},y:{field:"dEdx",type:"quantitative",scale:{type:"log"},axis:{title:"dE/dx [MeV/g/cm2]"}},color:{field:"material",
type:"nominal"}}};PlotData.fig=a;PlotData.update()}},update:function(){console.log("drawing");vegaEmbed("#catima_plot",PlotData.fig,{mode:"vega-lite",actions:!1})},plot_options:[{value:"dEdx",name:"dEdx"},{value:"range",name:"Range"},{value:"d/R",name:"th./range"}],change_y_axis:function(a){"dEdx"==a&&(PlotData.fig.data.values=PlotData.values,PlotData.fig.encoding.y.axis.title="dE/dx [MeV/g/cm2]",PlotData.fig.encoding.y.field=a,PlotData.fig.encoding.y.scale.type="log");"range"==a&&(PlotData.fig.data.values=
PlotData.values,PlotData.fig.encoding.y.axis.title="range [g/cm2]",PlotData.fig.encoding.y.field=a,PlotData.fig.encoding.y.scale.type="log");"d/R"==a&&(PlotData.derived(),PlotData.fig.data.values=PlotData.derived_values,PlotData.fig.encoding.y.axis.title="thickness/range",PlotData.fig.encoding.y.scale.type="log",PlotData.fig.encoding.y.field="y");PlotData.update()}};
PlotComponent.view=function(a){return m("div",{class:styles.div_row},[PlotData.plot_options?m("div",{class:styles.div_cell_20},[m("label",{class:styles.label},"Plot"),m("select",{onchange:m.withAttr("value",PlotData.change_y_axis)},PlotData.plot_options.map(function(a){return m("option",{value:a.value},a.name)}))]):null,m("div",{class:styles.div_cell_80},m(VegaPlot,PlotData))])};
function debounce(a,b){var c;return function(){var d=this,e=arguments;clearTimeout(c);c=setTimeout(function(){c=null;a.apply(d,e)},b)}}var enterescape=function(a,b){return function(c){c.redraw=!1;13===c.keyCode?(a(),m.redraw()):27===c.keyCode&&(b(),m.redraw())}},escape=function(a){return function(b){b.redraw=!1;27===b.keyCode&&(a(),m.redraw())}};
function svg_delete(a){return'<svg height="24" width="24"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'}function svg_down(a){return'<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z" fill="#010101"/></svg>'}
function svg_up(a){return'<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0V0z" fill="none"/><path d="M4 12l1.41 1.41L11 7.83V20h2V7.83l5.58 5.59L20 12l-8-8-8 8z"/></svg>'}
function svg_edit(a){return'<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/><path d="M0 0h24v24H0z" fill="none"/></svg>'}
function svg_settings(a){return'<svg fill="#FFFFFF" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M19.43 12.98c.04-.32.07-.64.07-.98s-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.12-.22-.39-.3-.61-.22l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.23-.09-.49 0-.61.22l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98s.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.12.22.39.3.61.22l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.23.09.49 0 .61-.22l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zM12 15.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5z"/></svg>'}
function svg_add(a){return'<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>'}
function svg_info(a){return'<svg fill="#000000" height="24" viewBox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg"><path d="M0 0h24v24H0z" fill="none"/><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>'}function button_route(a,b){return m("a",{class:styles.button,onclick:function(){m.route.set(b)}},a)}function button(a,b,c){return m("a",{class:c?c:styles.button,onclick:b},a)}
function text_error(a){return m("span",{class:styles.color_error},a)}function badge_error(a){return m("div",{class:styles.error_badge},a)}function SaveFile(a,b){a=new Blob(["string"===typeof a?a:JSON.stringify(a,null,"\t")],{type:"text/plain;charset=utf-8"});saveAs(a,b)}
function FileLoader(a,b){return[m("input",{class:"my-remove",type:"file",id:a.id,onchange:function(a){b(a.target.files[0]);a.target.value=null}}),m("a",{class:a.class,onclick:function(){document.getElementById(a.id).click()}},a.title)]}withAttr_nr=function(a,b,c){return function(d){d.redraw=!1;b.call(c||this,a in d.currentTarget?d.currentTarget[a]:d.currentTarget.getAttribute(a))}};noredraw=function(a,b){return function(c){c.redraw=!1;a.call(b||this)}};
append_script=function(a){var b=[];a.forEach(function(a){var c=new Promise(function(b,c){c=document.createElement("script");c.src=a;c.async=!1;c.onload=function(){b()};document.head.appendChild(c)});b.push(c)});return Promise.all(b)};get_window_size=function(){return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight]};
get_div_size=function(a){var b=document.getElementById(a).clientWidth;a=document.getElementById(a).clientHeight;return[b,a]};var CardComponent={view:function(a){return m("article",{class:styles.card,style:"overflow:hidden;"},[m("div",{class:styles.card_header},a.attrs.title),m("div",{class:styles.card_main},a.attrs.content)])}};
function ToggleComponent2(a){var b=a.attrs,c=!1,d=function(){c=!c};return{toggle:d,view:function(){return m("div",{class:styles.div_column},[button(c?b.title+" ^":b.title+" +",d),c?m("div",{class:styles.div_cell+" "+styles.box,id:b.id},b.content):null])}}}
var ToggleComponent={visible:!1,off:function(a){document.getElementById(a).style.display="none";ToggleComponent.visible=!1},toggle:function(a){document.getElementById(a).style.display=ToggleComponent.visible?"none":"block";ToggleComponent.visible=!ToggleComponent.visible},oninit:function(){ToggleComponent.visible=!1},view:function(a){var b=a.attrs,c=ToggleComponent.visible?b.title+" ^":b.title+" +";return m("div",{class:ToggleComponent.visible?styles.combine([styles.box,styles.div_column]):styles.div_column},
[button(c,ToggleComponent.toggle.bind(a.state,b.id)),m("div",{class:styles.div_cell,id:b.id,style:"display:none;"},b.content)])}};function relative_momentum_deviation(a,b){var c=0;0<b&&(c=NucKinematics.gamma_from_T(b),c=c*a/b/(c+1));return c}function LoadJSONFile(a){var b=new FileReader;b.onload=function(a){return function(a){try{App.Load(JSON.parse(a.target.result)),App.Save()}catch(e){}finally{m.redraw()}}}(a);b.readAsText(a)}
function AddLayersFromFile(a){var b=new FileReader;b.onload=function(a){return function(a){try{App.AddLayers(JSON.parse(a.target.result)),App.Save()}catch(e){}finally{m.redraw()}}}(a);b.readAsText(a)}var App=App||{};App.state={};App.state.nuc="";App.state.T=0;App.state.matter=[];App.state.config=new catima_config;App.info="";App.projectile=new SharpCalculator;App.get_editindex=function(){return MatterEditor.vm.editindex};
App.Load=function(a){a&&(a.nuc&&Array.isArray(a.nuc)&&App.projectile.SetNucleus(a.nuc[0],a.nuc[1],a.nuc[2]),a.T&&App.projectile.Set.T(a.T),MatterEditor.vm.layers.length=0,App.AddLayers(a),MatterEditor.vm.calculate(),a.config&&App.state.config.set(a.config),App.loaded=!0,App.Save())};App.AddLayers=function(a){if(a.matter)for(var b=0;b<a.matter.length;b++)MatterEditor.vm.layers.push(new MatterLayer(a.matter[b]))};
App.Save=function(){App.state.nuc=App.projectile.GetNucleus();App.state.T=App.projectile.state.T;App.state.matter=MatterEditor.vm.layers;App.state.units=[1,1E3,1];StorageAPI.save("state",App.state)};
App.MOCADIstr=function(){var a=App.projectile.GetNucleus(),b=MatterEditor.vm.layers;a="epax 2\natima-1.0\noption listmode tree\nBEAM\n20000\n"+App.projectile.state.T+", 0, "+a[0]+", "+a[1]+", "+(a[1]-a[2])+"\n";a+="2\n0, 0, 0, 0, 0\n2\n0, 0, 0, 0, 0\n2\n0, 0, 0, 0, 0\n*\nERWARTUNGSWERTE START\nSAVE START";for(var c=0;c<b.length;c++){var d="\n*** "+b[c].name+" ***\nMATTER\n"+(b[c].A||0)+", "+b[c].Z+", "+1E3*b[c].rho;d=d+"\n3, "+b[c].th;d+="\n0\n0, 0, 0";d+="\n1, 1, 0\n0";a+=d}return a+"\n*\nERWARTUNGSWERTE END\nSAVE END\nEND"};
App.fileapi=!1;App.datavalid=!1;App.loaded=!1;App.clear_cache=function(){App.datavalid=!1;Catima&&Catima.clear()};function FooterComponent(){App.state.config.is_same(config_atima13)?App.info="setting: ATIMA v1.3":App.state.config.is_same(config_atima14)?App.info="setting: ATIMA v1.4":App.info="setting: custom";return m("footer",{class:styles.footer},m("span",{style:"color:#666",class:"f7"},App.info))}function NavigationComponent(a){return m("nav",{class:styles.nav},a)}
var NavigationList_Main=function(){return[m("a",{class:styles.nav_item,onclick:function(){SaveFile(App.state,"webatima_input.json")}},"Save"),FileLoader({class:styles.nav_item,title:"Load",id:"apploader"},LoadJSONFile),m("a",{class:styles.nav_item_right+" fr",href:"about.html",target:"_blank"},"About"),m("a",{class:styles.nav_item_right+" fr ",onclick:function(){m.route.set("/config")}},[m.trust(svg_settings()),"Settings"])]},NavigationList_NucChange=function(){return[m("a",{class:styles.nav_item,
onclick:function(){m.route.set("/")}},"Back")]},NavigationList_Results=function(){return[m("a",{class:styles.nav_item,onclick:function(){m.route.set("/")}},"Back"),m("a",{class:styles.nav_item,onclick:function(){m.route.set("/nucchange")}},"Projectile"),m("a",{class:styles.nav_item_right,href:"about.html",target:"_blank"},"About")]},MainPage={oninit:function(){if(!App.loaded){window.FileReader&&(App.fileapi=!0);var a=StorageAPI.load("state");App.Load(a)}},view:function(a){return[m("div",{class:styles.container_narrow},
[NavigationComponent(NavigationList_Main()),m("div",{class:styles.combine([styles.div_row,styles.padding_vertical])},[m("div",{class:styles.div_cell_20a},m(CardComponent,{title:"Projectile",content:m(NucleusInfo,{nucleus:App.projectile})})),m("div",{class:styles.div_cell_80},m(CardComponent,{title:"Matter",content:m(MatterEditor)}))]),m("div",{class:styles.combine([styles.div_row,styles.padding_vertical])},m("div",{class:styles.div_cell_full},[m("h2","Results"),m("a",{class:styles.button_full,onclick:function(){-1==
MatterEditor.vm.editindex&&m.route.set("/results")}},"Calculate")]))]),FooterComponent()]}},NucChangePage={view:function(a){return m("div",{class:styles.container_narrow},[NavigationComponent(NavigationList_NucChange()),m(NucleusSelector)])}},ResultsPage={view:function(a){if(App.loaded)return[m("div",{class:styles.container},[NavigationComponent(NavigationList_Results()),m(AtimaResultsView)]),FooterComponent()];m.route.set("/")}},PlotPage={view:function(a){if(App.loaded)return m("div",{class:styles.container},
[NavigationComponent(NavigationList_NucChange()),m(PlotComponent)]);m.route.set("/")}},MaterialPlotPage={view:function(a){if(App.loaded)return m("div",{class:styles.container},[NavigationComponent(NavigationList_NucChange()),m(MaterialPlotComponent)]);m.route.set("/")}},ConfigPage={view:function(a){return m("div",{class:styles.container_narrow},[NavigationComponent(NavigationList_NucChange()),m(ConfigComponent)])}};
m.route(document.getElementById("NS"),"/",{"/":MainPage,"/nucchange":NucChangePage,"/results":ResultsPage,"/plot":PlotPage,"/materialplot":MaterialPlotPage,"/config":ConfigPage});
